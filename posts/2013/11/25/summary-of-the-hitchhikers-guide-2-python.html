<!DOCTYPE html>
<html lang="en">
<head>
        <title>[摘要]Python 最佳实践指南</title>
        <meta charset="utf-8" />
     <meta name="description" content="">
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

        <link rel="shortcut icon" href="/favicon.ico"/>
        <link rel="stylesheet" href="http://wklken.me/theme/css/style.css" media="all" />
        <link rel="stylesheet" href="http://wklken.me/theme/css/pygment.css" media="all" />
        <link rel="stylesheet" href="http://wklken.me/theme/css/mobile.css" media="all" />
        <link href="http://fonts.googleapis.com/css?family=Open+Sans:400italic,700italic,300italic,600italic,400,600,700,800' rel='stylesheet' type='text/css">

        <link rel="stylesheet" href="http://wklken.me/theme/css/font-awesome.min.css">
        <!--[if IE 7]>
            <link rel="stylesheet" href="http://wklken.me/theme/css/font-awesome-ie7.min.css">
        <![endif]-->

        <link href="http://wklken.me/" type="application/atom+xml" rel="alternate" title="wklken's blog ATOM Feed" />
        <link href="http://wklken.me/feed.xml" type="application/atom+xml" rel="alternate" title="wklken's blog RSS Feed" />

        <!--[if IE]>
                <script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

        <!--[if lte IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://wklken.me/css/ie.css"/>
                <script src="http://wklken.me/js/IE8.js" type="text/javascript"></script><![endif]-->

        <!--[if lt IE 7]>
                <link rel="stylesheet" type="text/css" media="all" href="http://wklken.me/css/ie6.css"/><![endif]-->
        <script src="http://upcdn.b0.upaiyun.com/libs/jquery/jquery-1.9.1.min.js"></script>
        <script src="http://wklken.me/theme/js/jquery.scrollToTop.js"></script>
        <script type="text/javascript">
            $(function() {
                $("#toTop").scrollToTop(1000);
            });
        </script>

</head>

<body id="index" class="home">
  <header id="header">
     <div class="constraint">

       <div class="o"> 
   <a href="/"><h1>Wklken <span class="red"> Python</span></h1></a>

    <div class="social">
                <a href="https://github.com/wklken" target='_blank'><i class="icon-github-sign icon-2x"></i></a>
                <a href="http://weibo.com/wklken" target='_blank'><i class="icon-weibo icon-2x"></i></a>
                <a href="mailto:wklken@yeah.net"><i class="icon-envelope icon-2x"></i></a>
                <a href="/feed.xml" target='_blank'><i class="icon-rss-sign icon-2x"></i></a>
    </div>

		<div class="nav">
                    <a href="/">首页</a>
                    <a href="/categories.html">分类</a>
                    <a href="/archives.html">归档</a>
                    <a href="/pages/projects.html">项目</a>
                    <a href="/pages/tools.html">工具</a>
                    <a href="/pages/books.html">书单</a>
                    <a href="/pages/aboutme.html">关于</a>

           </div>
         </div>
         </div>
         </header><!-- /#banner -->

<section class="content blog">
<div class="constraint">
<div class="posts">
<article>
<aside class="sidebar">
<h3 class="published" title="2013-11-25T00:00:00">
               2013年11月25日
</h3>

<p>
<div class="tag">
    分类: <a href="/category/python.html">python</a>

    </div>


<div class="tag">
    标签: <a href="http://wklken.me/tag/python.html">python</a>
   </div>


</p>

</aside><!-- /.post-info -->        <header> <h1 class="blog-title"><a href=""
        rel="bookmark" title="Permalink to [摘要]Python 最佳实践指南">[摘要]Python 最佳实践指南</a></h1> 
        </header>


        <div class="entry-content">
        <p>文档地址 <a href="http://docs.python-guide.org/en/latest/">The Hitchhiker's Guide to Python!</a></p>
<p>花了一个小时粗粗粗略地过了一遍，捞了一些东西出来</p>
<p>有些地方没有细读</p>
<p>大体摘了一些出来，都是代码，大段大段英文太费眼了，回头细读在更新进来</p>
<p>这份文档</p>
<div class="highlight"><pre><span class="err">目标对象：入门后，有一定基础的</span><span class="n">Pythonista</span>
<span class="err">关键词：最佳实践，工具目录</span>
</pre></div>


<p>整体内容还是很不错的，建议细读英文</p>
<hr />
<h1>第零部分 Getting Started</h1>
<p>http://docs.python-guide.org/en/latest/#getting-started</p>
<p>不解释，不翻译，自个看....真的没啥</p>
<hr />
<h1>第一部分 Writing Great Code</h1>
<h3>Structuring Your Project</h3>
<p>http://docs.python-guide.org/en/latest/writing/structure/#structuring-your-project</p>
<p>import 最佳实践</p>
<p>Very bad</p>
<div class="highlight"><pre><span class="k">[...]</span>
<span class="err">from</span> <span class="err">modu</span> <span class="err">import</span> <span class="err">*</span>
<span class="k">[...]</span>
<span class="na">x</span> <span class="o">=</span> <span class="s">sqrt(4)  # Is sqrt part of modu? A builtin? Defined above?</span>
</pre></div>


<p>Better</p>
<div class="highlight"><pre><span class="n">from</span> <span class="n">modu</span> <span class="n">import</span> <span class="n">sqrt</span>
<span class="p">[...]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="err">#</span> <span class="n">sqrt</span> <span class="n">may</span> <span class="n">be</span> <span class="n">part</span> <span class="n">of</span> <span class="n">modu</span><span class="p">,</span> <span class="k">if</span> <span class="n">not</span> <span class="n">redefined</span> <span class="n">in</span> <span class="n">between</span>
</pre></div>


<p>Best</p>
<div class="highlight"><pre><span class="n">import</span> <span class="n">modu</span>
<span class="p">[...]</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">modu</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="err">#</span> <span class="n">sqrt</span> <span class="n">is</span> <span class="n">visibly</span> <span class="n">part</span> <span class="n">of</span> <span class="n">modu</span><span class="err">&#39;</span><span class="n">s</span> <span class="n">namespace</span>
</pre></div>


<p>packages</p>
<p>Decorators</p>
<div class="highlight"><pre><span class="n">def</span> <span class="n">foo</span><span class="p">()</span><span class="o">:</span>
    <span class="err">#</span> <span class="k">do</span> <span class="n">something</span>

<span class="n">def</span> <span class="n">decorator</span><span class="p">(</span><span class="n">func</span><span class="p">)</span><span class="o">:</span>
    <span class="err">#</span> <span class="n">manipulate</span> <span class="n">func</span>
    <span class="k">return</span> <span class="n">func</span>

<span class="n">foo</span> <span class="o">=</span> <span class="n">decorator</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>  <span class="err">#</span> <span class="n">Manually</span> <span class="n">decorate</span>

<span class="err">@</span><span class="n">decorator</span>
<span class="n">def</span> <span class="n">bar</span><span class="p">()</span><span class="o">:</span>
    <span class="err">#</span> <span class="n">Do</span> <span class="n">something</span>
<span class="cp"># bar() is decorated</span>
</pre></div>


<p>动态类型(Dynamic typing)</p>
<p>Avoid using the same variable name for different things.</p>
<p>Bad</p>
<div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">a</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">a</span> <span class="n">string</span><span class="err">&#39;</span>
<span class="n">def</span> <span class="n">a</span><span class="p">()</span><span class="o">:</span>
    <span class="n">pass</span>  <span class="err">#</span> <span class="n">Do</span> <span class="n">something</span>
</pre></div>


<p>Good</p>
<div class="highlight"><pre><span class="n">count</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">msg</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">a</span> <span class="n">string</span><span class="err">&#39;</span>
<span class="n">def</span> <span class="n">func</span><span class="p">()</span><span class="o">:</span>
    <span class="n">pass</span>  <span class="err">#</span> <span class="n">Do</span> <span class="n">something</span>
</pre></div>


<p>It is better to use different names even for things that are related, when they have a different type:</p>
<div class="highlight"><pre><span class="n">Bad</span>

<span class="n">items</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">a</span> <span class="n">b</span> <span class="n">c</span> <span class="n">d</span><span class="err">&#39;</span>  <span class="err">#</span> <span class="n">This</span> <span class="n">is</span> <span class="n">a</span> <span class="n">string</span><span class="p">...</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">items</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="sc">&#39; &#39;</span><span class="p">)</span>  <span class="err">#</span> <span class="p">...</span><span class="n">becoming</span> <span class="n">a</span> <span class="n">list</span>
<span class="n">items</span> <span class="o">=</span> <span class="n">set</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>  <span class="err">#</span> <span class="p">...</span><span class="n">and</span> <span class="n">then</span> <span class="n">a</span> <span class="n">set</span>
</pre></div>


<p>可变和不可变类型(Mutable and immutable types)</p>
<p>字符串拼接最佳实践</p>
<p>Bad</p>
<div class="highlight"><pre><span class="cp"># create a concatenated string from 0 to 19 (e.g. &quot;012..1819&quot;)</span>
<span class="n">nums</span> <span class="o">=</span> <span class="s">&quot;&quot;</span>
<span class="k">for</span> <span class="n">n</span> <span class="n">in</span> <span class="n">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">:</span>
  <span class="n">nums</span> <span class="o">+=</span> <span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>   <span class="err">#</span> <span class="n">slow</span> <span class="n">and</span> <span class="n">inefficient</span>
<span class="n">print</span> <span class="n">nums</span>
</pre></div>


<p>Good</p>
<div class="highlight"><pre><span class="cp"># create a concatenated string from 0 to 19 (e.g. &quot;012..1819&quot;)</span>
<span class="n">nums</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">n</span> <span class="n">in</span> <span class="n">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">:</span>
  <span class="n">nums</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
<span class="n">print</span> <span class="s">&quot;&quot;</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>  <span class="err">#</span> <span class="n">much</span> <span class="n">more</span> <span class="n">efficient</span>
</pre></div>


<p>Best</p>
<div class="highlight"><pre><span class="cp"># create a concatenated string from 0 to 19 (e.g. &quot;012..1819&quot;)</span>
<span class="n">nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">str</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="n">in</span> <span class="n">range</span><span class="p">(</span><span class="mi">20</span><span class="p">)]</span>
<span class="n">print</span> <span class="s">&quot;&quot;</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">nums</span><span class="p">)</span>
</pre></div>


<p>join() is not always best
创建新字符串和修改原有字符串</p>
<div class="highlight"><pre><span class="n">foo</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">foo</span><span class="err">&#39;</span>
<span class="n">bar</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">bar</span><span class="err">&#39;</span>

<span class="n">foobar</span> <span class="o">=</span> <span class="n">foo</span> <span class="o">+</span> <span class="n">bar</span>  <span class="err">#</span> <span class="n">This</span> <span class="n">is</span> <span class="n">good</span>
<span class="n">foo</span> <span class="o">+=</span> <span class="err">&#39;</span><span class="n">ooo</span><span class="err">&#39;</span>  <span class="err">#</span> <span class="n">This</span> <span class="n">is</span> <span class="n">bad</span><span class="p">,</span> <span class="n">instead</span> <span class="n">you</span> <span class="n">should</span> <span class="k">do</span><span class="o">:</span>
<span class="n">foo</span> <span class="o">=</span> <span class="err">&#39;&#39;</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="n">foo</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">ooo</span><span class="err">&#39;</span><span class="p">])</span>
</pre></div>


<p>字符串格式化</p>
<div class="highlight"><pre><span class="n">foo</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">foo</span><span class="err">&#39;</span>
<span class="n">bar</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">bar</span><span class="err">&#39;</span>

<span class="n">foobar</span> <span class="o">=</span> <span class="err">&#39;</span><span class="o">%</span><span class="n">s</span><span class="o">%</span><span class="n">s</span><span class="err">&#39;</span> <span class="o">%</span> <span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">)</span> <span class="err">#</span> <span class="n">It</span> <span class="n">is</span> <span class="n">OK</span>
<span class="n">foobar</span> <span class="o">=</span> <span class="err">&#39;</span><span class="p">{</span><span class="mi">0</span><span class="p">}{</span><span class="mi">1</span><span class="p">}</span><span class="err">&#39;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="p">)</span> <span class="err">#</span> <span class="n">It</span> <span class="n">is</span> <span class="n">better</span>
<span class="n">foobar</span> <span class="o">=</span> <span class="err">&#39;</span><span class="p">{</span><span class="n">foo</span><span class="p">}{</span><span class="n">bar</span><span class="p">}</span><span class="err">&#39;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="n">foo</span><span class="o">=</span><span class="n">foo</span><span class="p">,</span> <span class="n">bar</span><span class="o">=</span><span class="n">bar</span><span class="p">)</span> <span class="err">#</span> <span class="n">It</span> <span class="n">is</span> <span class="n">best</span>
</pre></div>


<h3>Code Style</h3>
<p>http://docs.python-guide.org/en/latest/writing/style/#code-style</p>
<h4>一般概念(General concepts)</h4>
<p>明确的代码</p>
<p>Bad</p>
<div class="highlight"><pre><span class="n">def</span> <span class="n">make_complex</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">:</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">args</span>
    <span class="k">return</span> <span class="n">dict</span><span class="p">(</span><span class="o">**</span><span class="n">locals</span><span class="p">())</span>
</pre></div>


<p>Good</p>
<div class="highlight"><pre><span class="n">def</span> <span class="n">make_complex</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">:</span>
    <span class="k">return</span> <span class="p">{</span><span class="sc">&#39;x&#39;</span><span class="o">:</span> <span class="n">x</span><span class="p">,</span> <span class="sc">&#39;y&#39;</span><span class="o">:</span> <span class="n">y</span><span class="p">}</span>
</pre></div>


<p>每行一个声明</p>
<p>Bad</p>
<div class="highlight"><pre><span class="n">print</span> <span class="err">&#39;</span><span class="n">one</span><span class="err">&#39;</span><span class="p">;</span> <span class="n">print</span> <span class="err">&#39;</span><span class="n">two</span><span class="err">&#39;</span>

<span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="o">:</span> <span class="n">print</span> <span class="err">&#39;</span><span class="n">one</span><span class="err">&#39;</span>

<span class="k">if</span> <span class="o">&lt;</span><span class="n">complex</span> <span class="n">comparison</span><span class="o">&gt;</span> <span class="n">and</span> <span class="o">&lt;</span><span class="n">other</span> <span class="n">complex</span> <span class="n">comparison</span><span class="o">&gt;:</span>
    <span class="err">#</span> <span class="k">do</span> <span class="n">something</span>
</pre></div>


<p>Good</p>
<div class="highlight"><pre><span class="n">print</span> <span class="err">&#39;</span><span class="n">one</span><span class="err">&#39;</span>
<span class="n">print</span> <span class="err">&#39;</span><span class="n">two</span><span class="err">&#39;</span>

<span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">1</span><span class="o">:</span>
    <span class="n">print</span> <span class="err">&#39;</span><span class="n">one</span><span class="err">&#39;</span>

<span class="n">cond1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">complex</span> <span class="n">comparison</span><span class="o">&gt;</span>
<span class="n">cond2</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">other</span> <span class="n">complex</span> <span class="n">comparison</span><span class="o">&gt;</span>
<span class="k">if</span> <span class="n">cond1</span> <span class="n">and</span> <span class="n">cond2</span><span class="o">:</span>
    <span class="err">#</span> <span class="k">do</span> <span class="n">something</span>
</pre></div>


<h4>方言(Idioms)</h4>
<p>Unpacking</p>
<div class="highlight"><pre><span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">item</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">some_list</span><span class="p">)</span><span class="o">:</span>
    <span class="err">#</span> <span class="k">do</span> <span class="n">something</span> <span class="n">with</span> <span class="n">index</span> <span class="n">and</span> <span class="n">item</span>

<span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">=</span> <span class="n">b</span><span class="p">,</span> <span class="n">a</span>

<span class="n">a</span><span class="p">,</span> <span class="p">(</span><span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">)</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>


<p>忽略接收变量,这里用的是两个下划线，原因
http://docs.python-guide.org/en/latest/writing/style/#create-an-ignored-variable</p>
<div class="highlight"><pre><span class="n">filename</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">foobar</span><span class="p">.</span><span class="n">txt</span><span class="err">&#39;</span>
<span class="n">basename</span><span class="p">,</span> <span class="n">__</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">filename</span><span class="p">.</span><span class="n">rpartition</span><span class="p">(</span><span class="sc">&#39;.&#39;</span><span class="p">)</span>
</pre></div>


<p>同一个元素创建一个长度为N的列表</p>
<div class="highlight"><pre><span class="n">four_nones</span> <span class="o">=</span> <span class="p">[</span><span class="n">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">4</span>
</pre></div>


<p>创建一个长度N的嵌套列表</p>
<div class="highlight"><pre><span class="n">four_lists</span> <span class="o">=</span> <span class="p">[[]</span> <span class="k">for</span> <span class="n">__</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">4</span><span class="p">)]</span>
</pre></div>


<p>由列表拼接字符串</p>
<div class="highlight"><pre><span class="n">letters</span> <span class="o">=</span> <span class="p">[</span><span class="sc">&#39;s&#39;</span><span class="p">,</span> <span class="sc">&#39;p&#39;</span><span class="p">,</span> <span class="sc">&#39;a&#39;</span><span class="p">,</span> <span class="sc">&#39;m&#39;</span><span class="p">]</span>
<span class="n">word</span> <span class="o">=</span> <span class="err">&#39;&#39;</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">letters</span><span class="p">)</span>
</pre></div>


<p>快速查找</p>
<div class="highlight"><pre><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;s&#39;</span><span class="o">:</span> <span class="p">[],</span> <span class="sc">&#39;p&#39;</span><span class="o">:</span> <span class="p">[],</span> <span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="p">[],</span> <span class="sc">&#39;m&#39;</span><span class="o">:</span> <span class="p">[]}</span>
<span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="sc">&#39;s&#39;</span><span class="p">,</span> <span class="sc">&#39;p&#39;</span><span class="p">,</span> <span class="sc">&#39;a&#39;</span><span class="p">,</span> <span class="sc">&#39;m&#39;</span><span class="p">]</span>

<span class="n">def</span> <span class="n">lookup_dict</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">:</span> <span class="err">#</span><span class="n">O</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="sc">&#39;s&#39;</span> <span class="n">in</span> <span class="n">d</span>

<span class="n">def</span> <span class="n">lookup_list</span><span class="p">(</span><span class="n">l</span><span class="p">)</span><span class="o">:</span> <span class="err">#</span><span class="n">O</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="sc">&#39;s&#39;</span> <span class="n">in</span> <span class="n">l</span>
</pre></div>


<h3>惯例(Conventions)</h3>
<p>判断值是否等于常量</p>
<p>Bad:</p>
<div class="highlight"><pre><span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="n">True</span><span class="o">:</span>
    <span class="n">print</span> <span class="err">&#39;</span><span class="n">True</span><span class="o">!</span><span class="err">&#39;</span>

<span class="k">if</span> <span class="n">attr</span> <span class="o">==</span> <span class="n">None</span><span class="o">:</span>
    <span class="n">print</span> <span class="err">&#39;</span><span class="n">attr</span> <span class="n">is</span> <span class="n">None</span><span class="o">!</span><span class="err">&#39;</span>
</pre></div>


<p>Good:</p>
<div class="highlight"><pre><span class="cp"># Just check the value</span>
<span class="k">if</span> <span class="n">attr</span><span class="o">:</span>
    <span class="n">print</span> <span class="err">&#39;</span><span class="n">attr</span> <span class="n">is</span> <span class="n">truthy</span><span class="o">!</span><span class="err">&#39;</span>

<span class="cp"># or check for the opposite</span>
<span class="k">if</span> <span class="n">not</span> <span class="n">attr</span><span class="o">:</span>
    <span class="n">print</span> <span class="err">&#39;</span><span class="n">attr</span> <span class="n">is</span> <span class="n">falsey</span><span class="o">!</span><span class="err">&#39;</span>

<span class="cp"># or, since None is considered false, explicitly check for it</span>
<span class="k">if</span> <span class="n">attr</span> <span class="n">is</span> <span class="n">None</span><span class="o">:</span>
    <span class="n">print</span> <span class="err">&#39;</span><span class="n">attr</span> <span class="n">is</span> <span class="n">None</span><span class="o">!</span><span class="err">&#39;</span>
</pre></div>


<p>获取字典元素</p>
<p>Bad:</p>
<div class="highlight"><pre><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="err">&#39;</span><span class="n">hello</span><span class="err">&#39;</span><span class="o">:</span> <span class="err">&#39;</span><span class="n">world</span><span class="err">&#39;</span><span class="p">}</span>
<span class="k">if</span> <span class="n">d</span><span class="p">.</span><span class="n">has_key</span><span class="p">(</span><span class="err">&#39;</span><span class="n">hello</span><span class="err">&#39;</span><span class="p">)</span><span class="o">:</span>
    <span class="n">print</span> <span class="n">d</span><span class="p">[</span><span class="err">&#39;</span><span class="n">hello</span><span class="err">&#39;</span><span class="p">]</span>    <span class="err">#</span> <span class="n">prints</span> <span class="err">&#39;</span><span class="n">world</span><span class="err">&#39;</span>
<span class="nl">else:</span>
    <span class="n">print</span> <span class="err">&#39;</span><span class="n">default_value</span><span class="err">&#39;</span>
</pre></div>


<p>Good:</p>
<div class="highlight"><pre><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="err">&#39;</span><span class="n">hello</span><span class="err">&#39;</span><span class="o">:</span> <span class="err">&#39;</span><span class="n">world</span><span class="err">&#39;</span><span class="p">}</span>

<span class="n">print</span> <span class="n">d</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="err">&#39;</span><span class="n">hello</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">default_value</span><span class="err">&#39;</span><span class="p">)</span> <span class="err">#</span> <span class="n">prints</span> <span class="err">&#39;</span><span class="n">world</span><span class="err">&#39;</span>
<span class="n">print</span> <span class="n">d</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="err">&#39;</span><span class="n">thingy</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">default_value</span><span class="err">&#39;</span><span class="p">)</span> <span class="err">#</span> <span class="n">prints</span> <span class="err">&#39;</span><span class="n">default_value</span><span class="err">&#39;</span>

<span class="cp"># Or:</span>
<span class="k">if</span> <span class="err">&#39;</span><span class="n">hello</span><span class="err">&#39;</span> <span class="n">in</span> <span class="n">d</span><span class="o">:</span>
    <span class="n">print</span> <span class="n">d</span><span class="p">[</span><span class="err">&#39;</span><span class="n">hello</span><span class="err">&#39;</span><span class="p">]</span>
</pre></div>


<p>快捷列表操作</p>
<p>Bad:</p>
<div class="highlight"><pre><span class="cp"># Filter elements greater than 4</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">a</span><span class="o">:</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="o">:</span>
        <span class="n">b</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
</pre></div>


<p>Good:</p>
<div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">a</span> <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">filter</span><span class="p">(</span><span class="n">lambda</span> <span class="n">x</span><span class="o">:</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">4</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>


<p>Bad:</p>
<div class="highlight"><pre><span class="cp"># Add three to all list members.</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">range</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">a</span><span class="p">))</span><span class="o">:</span>
    <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">3</span>
</pre></div>


<p>Good:</p>
<div class="highlight"><pre><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">3</span> <span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">a</span><span class="p">]</span>
<span class="cp"># Or:</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">map</span><span class="p">(</span><span class="n">lambda</span> <span class="n">i</span><span class="o">:</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">a</span><span class="p">)</span>
</pre></div>


<p>使用enumerate</p>
<div class="highlight"><pre><span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">:</span>
    <span class="n">print</span> <span class="n">i</span><span class="p">,</span> <span class="n">item</span>
<span class="cp"># prints</span>
<span class="cp"># 0 3</span>
<span class="cp"># 1 4</span>
<span class="cp"># 2 5</span>
</pre></div>


<p>读文件</p>
<p>Bad:</p>
<div class="highlight"><pre><span class="n">f</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="err">&#39;</span><span class="n">file</span><span class="p">.</span><span class="n">txt</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">a</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">read</span><span class="p">()</span>
<span class="n">print</span> <span class="n">a</span>
<span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>


<p>Good:</p>
<div class="highlight"><pre><span class="n">with</span> <span class="n">open</span><span class="p">(</span><span class="err">&#39;</span><span class="n">file</span><span class="p">.</span><span class="n">txt</span><span class="err">&#39;</span><span class="p">)</span> <span class="n">as</span> <span class="n">f</span><span class="o">:</span>
    <span class="k">for</span> <span class="n">line</span> <span class="n">in</span> <span class="n">f</span><span class="o">:</span>
        <span class="n">print</span> <span class="n">line</span>
</pre></div>


<p>超长的行</p>
<p>Bad:</p>
<div class="highlight"><pre><span class="nx">my_very_big_string</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;For a long time I used to go to bed early. Sometimes, \</span>
<span class="s2">    when I had put out my candle, my eyes would close so quickly that I had not even \</span>
<span class="s2">    time to say “I’m going to sleep.”&quot;&quot;&quot;</span>

<span class="nx">from</span> <span class="nx">some</span><span class="p">.</span><span class="nx">deep</span><span class="p">.</span><span class="nx">module</span><span class="p">.</span><span class="nx">inside</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">module</span> <span class="kr">import</span> <span class="nx">a_nice_function</span><span class="p">,</span> <span class="nx">another_nice_function</span><span class="p">,</span> <span class="o">\</span>
    <span class="nx">yet_another_nice_function</span>
</pre></div>


<p>Good:</p>
<div class="highlight"><pre><span class="nx">my_very_big_string</span> <span class="o">=</span> <span class="p">(</span>
    <span class="s2">&quot;For a long time I used to go to bed early. Sometimes, &quot;</span>
    <span class="s2">&quot;when I had put out my candle, my eyes would close so quickly &quot;</span>
    <span class="s2">&quot;that I had not even time to say “I’m going to sleep.”&quot;</span>
<span class="p">)</span>

<span class="nx">from</span> <span class="nx">some</span><span class="p">.</span><span class="nx">deep</span><span class="p">.</span><span class="nx">module</span><span class="p">.</span><span class="nx">inside</span><span class="p">.</span><span class="nx">a</span><span class="p">.</span><span class="nx">module</span> <span class="kr">import</span> <span class="p">(</span>
    <span class="nx">a_nice_function</span><span class="p">,</span> <span class="nx">another_nice_function</span><span class="p">,</span> <span class="nx">yet_another_nice_function</span><span class="p">)</span>
</pre></div>


<h3>Reading Great Code¶</h3>
<p>http://docs.python-guide.org/en/latest/writing/reading/#reading-great-code</p>
<p>几个推荐阅读源代码项目</p>
<p><a href="https://github.com/gleitz/howdoi">Howdoi</a></p>
<p><a href="https://github.com/mitsuhiko/flask">Flask</a></p>
<p><a href="https://github.com/mitsuhiko/werkzeug">Werkzeug</a></p>
<p><a href="https://github.com/kennethreitz/requests">Requests</a></p>
<p><a href="https://github.com/kennethreitz/tablib">Tablib</a></p>
<h3>文档(Documentation)</h3>
<p>http://docs.python-guide.org/en/latest/writing/documentation/#documentation</p>
<p>具体还是读原文吧</p>
<p>代码文档建议</p>
<p>Comments clarify code and begin with a hash (#).</p>
<p>In Python, docstrings describe modules, classes, and functions:</p>
<div class="highlight"><pre><span class="n">def</span> <span class="n">square_and_rooter</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">:</span>
    <span class="s">&quot;&quot;&quot;Returns the square root of self times self.&quot;&quot;&quot;</span>
</pre></div>


<p>注解代码块</p>
<p>Do not use triple-quote strings to comment code.</p>
<p>This is not a good practice, because line-oriented command-line tools such as grep will not be aware that the commented code is inactive.</p>
<p>It is better to add hashes at the proper indentation level for every commented line.</p>
<p>最佳实践:</p>
<div class="highlight"><pre><span class="err">不用三引号注解代码块</span>
<span class="err">每一行加#来注释</span>
</pre></div>


<h3>测试你的代码(Testing Your Code)</h3>
<p>http://docs.python-guide.org/en/latest/writing/tests/#testing-your-code</p>
<p>单元测试(Unittest)</p>
<div class="highlight"><pre><span class="n">import</span> <span class="n">unittest</span>

<span class="n">def</span> <span class="n">fun</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">:</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">1</span>

<span class="n">class</span> <span class="n">MyTest</span><span class="p">(</span><span class="n">unittest</span><span class="p">.</span><span class="n">TestCase</span><span class="p">)</span><span class="o">:</span>
    <span class="n">def</span> <span class="n">test</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">assertEqual</span><span class="p">(</span><span class="n">fun</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>


<p>文档测试(Doctest)</p>
<div class="highlight"><pre><span class="n">def</span> <span class="n">square</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">:</span>
    <span class="s">&quot;&quot;&quot;Squares x.</span>

    <span class="o">&gt;&gt;&gt;</span> <span class="n">square</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
    <span class="mi">4</span>
    <span class="o">&gt;&gt;&gt;</span> <span class="n">square</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">)</span>
    <span class="mi">4</span>
    <span class="s">&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="err">&#39;</span><span class="n">__main__</span><span class="err">&#39;</span><span class="o">:</span>
    <span class="n">import</span> <span class="n">doctest</span>
    <span class="n">doctest</span><span class="p">.</span><span class="n">testmod</span><span class="p">()</span>
</pre></div>


<p>相关工具</p>
<p><a href="http://pytest.org/latest/">py.text</a>
    $ pip install pytest</p>
<p><a href="http://readthedocs.org/docs/nose/en/latest/">Nose</a>
    $ pip install nose</p>
<p><a href="http://testrun.org/tox/latest/">tox</a>
    $ pip install tox</p>
<p><a href="http://pypi.python.org/pypi/unittest2">Unittest2</a>
    $ pip install unittest2</p>
<p><a href="http://www.voidspace.org.uk/python/mock/">mock</a>
    $ pip install mock</p>
<h3>Common Gotchas(不懂怎么翻...╮(╯▽╰)╭ )</h3>
<p>两个例子</p>
<p>1.可变默认参数</p>
<p>What You Wrote</p>
<div class="highlight"><pre><span class="n">def</span> <span class="n">append_to</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="p">[])</span><span class="o">:</span>
    <span class="n">to</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">to</span>
</pre></div>


<p>What You Might Have Expected to Happen</p>
<div class="highlight"><pre><span class="n">my_list</span> <span class="o">=</span> <span class="n">append_to</span><span class="p">(</span><span class="mi">12</span><span class="p">)</span>
<span class="n">print</span> <span class="n">my_list</span>

<span class="n">my_other_list</span> <span class="o">=</span> <span class="n">append_to</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="n">print</span> <span class="n">my_other_list</span>

<span class="p">[</span><span class="mi">12</span><span class="p">]</span>
<span class="p">[</span><span class="mi">42</span><span class="p">]</span>
</pre></div>


<p>What Does Happen</p>
<div class="highlight"><pre><span class="k">[12]</span>
<span class="k">[12, 42]</span>
</pre></div>


<p>What You Should Do Instead</p>
<div class="highlight"><pre><span class="n">def</span> <span class="n">append_to</span><span class="p">(</span><span class="n">element</span><span class="p">,</span> <span class="n">to</span><span class="o">=</span><span class="n">None</span><span class="p">)</span><span class="o">:</span>
    <span class="k">if</span> <span class="n">to</span> <span class="n">is</span> <span class="n">None</span><span class="o">:</span>
        <span class="n">to</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">to</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">element</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">to</span>
</pre></div>


<p>2.Late Binding Closures(又一个，延迟绑定闭包?)</p>
<p>What You Wrote</p>
<div class="highlight"><pre><span class="n">def</span> <span class="n">create_multipliers</span><span class="p">()</span><span class="o">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">lambda</span> <span class="n">x</span> <span class="o">:</span> <span class="n">i</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
</pre></div>


<p>What You Might Have Expected to Happen</p>
<div class="highlight"><pre><span class="k">for</span> <span class="n">multiplier</span> <span class="n">in</span> <span class="n">create_multipliers</span><span class="p">()</span><span class="o">:</span>
    <span class="n">print</span> <span class="n">multiplier</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>

<span class="mi">0</span>
<span class="mi">2</span>
<span class="mi">4</span>
<span class="mi">6</span>
<span class="mi">8</span>
</pre></div>


<p>What Does Happen</p>
<div class="highlight"><pre><span class="mi">8</span>
<span class="mi">8</span>
<span class="mi">8</span>
<span class="mi">8</span>
<span class="mi">8</span>
</pre></div>


<p>What You Should Do Instead</p>
<div class="highlight"><pre><span class="n">from</span> <span class="n">functools</span> <span class="n">import</span> <span class="n">partial</span>
<span class="n">from</span> <span class="n">operator</span> <span class="n">import</span> <span class="n">mul</span>

<span class="n">def</span> <span class="n">create_multipliers</span><span class="p">()</span><span class="o">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">partial</span><span class="p">(</span><span class="n">mul</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
</pre></div>


<h3>选择证书(Choosing a License)</h3>
<p>http://docs.python-guide.org/en/latest/writing/license/#choosing-a-license</p>
<p>http://three.org/openart/license_chooser/</p>
<hr />
<h1>第二部分 Scenario Guide</h1>
<p>都是介绍性质的，类似工具目录</p>
<p>具体自己翻吧 <a href="http://docs.python-guide.org/en/latest/#scenario-guide">位置</a></p>
<p>目录：</p>
<div class="highlight"><pre><span class="err">在处理，明天早上起来顺手一翻</span><span class="p">....</span>
</pre></div>


<hr />
<p>有需要自取.....</p>
<h1>第三部分 Shipping Great Code</h1>
<p>http://docs.python-guide.org/en/latest/#shipping-great-code</p>
<h1>第四部分 Development Environment</h1>
<p>http://docs.python-guide.org/en/latest/#development-environment</p>
<h1>第五部分 Additional Notes</h1>
<p>http://docs.python-guide.org/en/latest/#additional-notes</p>
<hr />
<p>The end!</p>
<p>2013-11-25</p>
<p>wklken</p>
        </div><!-- /.entry-content -->
        <div class="comments">
            如果文章对你有帮助，欢迎对wklken进行无负担小额赞助 <a href="https://me.alipay.com/wklken" target="_blank"> 支付宝 </a> <br>
            版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank" >Creative Commons BY-NC-ND 3.0</a>
        <h2>Comments !</h2>
            <div id="disqus_thread"></div>
            <script type="text/javascript">
               var disqus_identifier = "posts/2013/11/25/summary-of-the-hitchhikers-guide-2-python.html";
               (function() {
               var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
               dsq.src = 'http://wklken.disqus.com/embed.js';
               (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
              })();
            </script>
        </div>

        </article>
</div>


</div>
</section>
<script type="text/javascript">
    var disqus_shortname = 'wklken';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>


<!-- JiaThis Button BEGIN -->
<script type="text/javascript" >
var jiathis_config={
    siteNum:15,
    sm:"fav,copy,ishare,tsina,googleplus,fb,twitter,evernote,ydnote,sdonote,xianguo,digg,qingbiji,weixin",
    summary:"",
    boldNum:3,
    showClose:false,
    hideMore:true
}
</script>
<script type="text/javascript" src="http://v3.jiathis.com/code_mini/jiathis_r.js?btn=r2.gif&move=0" charset="utf-8"></script>
<!-- JiaThis Button END -->
<a href="#top" id="toTop" style="display: inline;"></a>



        <section id="extras" class="body">
        </section><!-- /#extras -->

		<footer id="footer">
		<p class="copyright">
                <address id="about" class="vcard body">
                    Powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Theme by <a href="https://github.com/daker">Adnane Belmadiaf</a> and modify by <a href="https://github.com/wklken">wklken</a> Social Icons by <a href="http://fortawesome.github.io/Font-Awesome/">Font-Awesome</a>.

                    <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text" property="dct:title" rel="dct:type">Theme licensed under <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">CC BY-SA 3.0</a>.
             </address><!-- /#about -->

			 </p>
        </footer><!-- /#contentinfo -->

    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-42275748-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>


</body>
</html>