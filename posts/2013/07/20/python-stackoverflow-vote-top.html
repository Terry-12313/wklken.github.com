<!DOCTYPE html>
<html lang="en">

<!--[if IE 8]> <html class="no-js lt-ie9" lang="en"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en"> <!--<![endif]-->

<head>
    <meta name="google-site-verification" content="SzE6WCs23qFevgBzRIuG9vcfLU0lW_Vd5hFT-cJOLBE" />
    <title>[翻译整理]stackoverflow python 百问</title>
    <meta charset="utf-8" />
    <meta name="description" content="">
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

        <link rel="shortcut icon" href="/favicon.ico"/>
        <link rel="stylesheet" href="/theme/css/styles.css" media="all" />
        <link rel="stylesheet" href="/theme/css/tab.css" media="all" />
        <link rel="stylesheet" href="/theme/css/jquery-ui.css" media="all" />

        <link rel="stylesheet" href="/theme/css/font-awesome.min.css">
        <!--[if IE 7]>
            <link rel="stylesheet" href="/theme/css/font-awesome-ie7.min.css">
        <![endif]-->

        <link href="/" type="application/atom+xml" rel="alternate" title="wklken's blog ATOM Feed" />
        <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="wklken's blog RSS Feed" />

</head>

<body id="index" class="home">
    <div id="page" class="row">
        <div class="large-8 large-centered columns">

        <header id="header">
            <div class="constraint">
                <div class="o">
                    <a href="/"><h1 class="banner">Wklken <span class="blue"> Python</span></h1></a>

                <div class="social">
                            <a href="https://github.com/wklken" target='_blank'><i class="icon-github-sign icon-2x"></i></a>
                            <a href="http://weibo.com/wklken" target='_blank'><i class="icon-weibo icon-2x"></i></a>
                            <a href="mailto:wklken@yeah.net"><i class="icon-envelope icon-2x"></i></a>
                            <a href="http://www.wklken.me/feed.xml" target='_blank'><i class="icon-rss-sign icon-2x"></i></a>
                </div>
                <div class="nav">
                            <a href="/">首页</a>
                            <a href="/categories.html">分类</a>
                            <a href="/archives.html">归档</a>
                            <a href="/pages/projects.html">项目</a>
                            <a href="/pages/tools.html">工具</a>
                            <a href="/pages/books.html">书单</a>
                            <a href="/pages/aboutme.html">关于</a>

                </div>

                </div>
            </div>
        </header><!-- /#banner -->

        <section id="main">

<article id="article">
    <section id="header">
        <!--
        <div class="meta">2013年07月20日</div>
        <h1 id="title"> [翻译整理]stackoverflow python 百问 </h1>
        -->
        <div class="meta"> &nbsp; </div>
        <h1> [翻译整理]stackoverflow python 百问 </h1>
    </section>
    <section id="content">
        <p>更新到github了，地址：https://github.com/wklken/stackoverflow-py-top-qa </p>
<p>后续这里不更新了哈</p>
<hr />
<p>进度40%，最近有点犯懒</p>
<p>刚刚注册，好东西</p>
<p>查看了下前面(vote前15页,挑了下,vote都是100+的样子,大概120个)的问题，<a href="http://stackoverflow.com/questions/tagged/python?page=1&amp;sort=votes&amp;pagesize=15">链接</a>, 大体梳理了下,本来想放一页搞定，奈何排版太乱，按类型分了下</p>
<p>第一页的前几个比较长，目测都有中文翻译版本，大家可以网上搜下</p>
<p>其他问题相对比较杂，有些简单，有些复杂，拉过来参考参考也不错</p>
<p>总结整理，复习印证(注意，合并了每个问题的多个答案，但是时间仓促，疏漏难免，感兴趣问题直接点链接看原文吧)</p>
<hr />
<h2>基本数据结构(列表，元组，字典等)</h2>
<h3>判断一个列表为空得最佳实践</h3>
<p>问题 <a href="http://stackoverflow.com/questions/53513/python-what-is-the-best-way-to-check-if-a-list-is-empty">链接</a></p>
<p>答案:</p>
<div class="codehilite"><pre><span class="k">if</span> <span class="n">not</span> <span class="n">a</span><span class="o">:</span>
    <span class="n">print</span> <span class="s">&quot;List is empty&quot;</span>
<span class="cp">#不要用len(a)来判断</span>
</pre></div>


<h3>为什么是string.join(list)而不是list.join(string)</h3>
<p>问题 <a href="http://stackoverflow.com/questions/493819/python-join-why-is-it-string-joinlist-instead-of-list-joinstring">链接</a></p>
<div class="codehilite"><pre><span class="n">my_list</span> <span class="o">=</span> <span class="p">[</span><span class="s">&quot;Hello&quot;</span><span class="p">,</span> <span class="s">&quot;world&quot;</span><span class="p">]</span>
<span class="n">print</span> <span class="s">&quot;-&quot;</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">my_list</span><span class="p">)</span>
<span class="cp">#为什么不是 my_list.join(&quot;-&quot;) 。。。。这个....</span>
</pre></div>


<p>答案：</p>
<p>因为所有可迭代对象都可以被连接，但是连接者总是字符串</p>
<h3>如何合并两个列表</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1720421/merge-two-lists-in-python">链接</a></p>
<div class="codehilite"><pre><span class="n">listone</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="n">listtwo</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="cp">#outcome we expect: mergedlist == [1, 2, 3, 4, 5, 6]</span>
</pre></div>


<p>1.不考虑顺序（原来问题不是很明确）</p>
<div class="codehilite"><pre><span class="n">listone</span> <span class="o">+</span> <span class="n">listtwo</span>
<span class="cp">#linstone.extend(listtwo)也行，就是会修改listone</span>
</pre></div>


<p>2.考虑顺序做些处理</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">listone</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">listtwo</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">itertools</span>
<span class="o">&gt;&gt;&gt;</span> <span class="k">for</span> <span class="n">item</span> <span class="n">in</span> <span class="n">itertools</span><span class="p">.</span><span class="n">chain</span><span class="p">(</span><span class="n">listone</span><span class="p">,</span> <span class="n">listtwo</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>     <span class="n">print</span> <span class="n">item</span>
<span class="p">...</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
<span class="mi">4</span>
<span class="mi">5</span>
<span class="mi">6</span>
</pre></div>


<h3>如何扁平一个二维数组</h3>
<p>问题 <a href="http://stackoverflow.com/questions/952914/making-a-flat-list-out-of-list-of-lists-in-python">链接</a></p>
<div class="codehilite"><pre><span class="n">l</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]]</span>
<span class="err">变为</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
</pre></div>


<p>列表解析</p>
<div class="codehilite"><pre><span class="p">[</span><span class="n">item</span> <span class="k">for</span> <span class="n">sublist</span> <span class="n">in</span> <span class="n">l</span> <span class="k">for</span> <span class="n">item</span> <span class="n">in</span> <span class="n">sublist</span><span class="p">]</span>
</pre></div>


<p>itertools</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">itertools</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">list2d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">merged</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="n">itertools</span><span class="p">.</span><span class="n">chain</span><span class="p">(</span><span class="o">*</span><span class="n">list2d</span><span class="p">))</span>

<span class="cp"># python &gt;= 2.6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">itertools</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">list2d</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],[</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span><span class="mi">9</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">merged</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="n">itertools</span><span class="p">.</span><span class="n">chain</span><span class="p">.</span><span class="n">from_iterable</span><span class="p">(</span><span class="n">list2d</span><span class="p">))</span>
</pre></div>


<p>sum</p>
<div class="codehilite"><pre><span class="n">sum</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="p">[])</span>
</pre></div>


<h3>如何获取一个列表的长度</h3>
<p>问题 <a href="http://stackoverflow.com/questions/518021/getting-the-length-of-an-array-in-python">链接</a></p>
<p>python中是不是只有这种方法可以获取长度？语法很奇怪</p>
<div class="codehilite"><pre><span class="n">arr</span><span class="p">.</span><span class="n">__len__</span><span class="p">()</span>
</pre></div>


<p>应该使用这种方式</p>
<div class="codehilite"><pre><span class="n">mylist</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">]</span>
<span class="n">len</span><span class="p">(</span><span class="n">mylist</span><span class="p">)</span>
</pre></div>


<p>这样做法，不需要对每个容器都定义一个.length()方法，你可以使用len()检查所有实现了__len__()方法的对象</p>
<h3>Python中如何复制一个列表</h3>
<p>问题 <a href="http://stackoverflow.com/questions/2612802/how-to-clone-a-list-in-python">链接</a></p>
<p>可以用切片的方法</p>
<div class="codehilite"><pre><span class="n">new_list</span> <span class="o">=</span> <span class="n">old_list</span><span class="p">[</span><span class="o">:</span><span class="p">]</span>
</pre></div>


<p>可以使用list()函数</p>
<div class="codehilite"><pre><span class="n">new_list</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="n">old_list</span><span class="p">)</span>
</pre></div>


<p>可以使用copy.copy(),比list()稍慢，因为它首先去查询old_list的数据类型</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">copy</span>
<span class="n">new_list</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="n">old_list</span><span class="p">)</span>
</pre></div>


<p>如果列表中包含对象，可以使用copy.deepcopy(), 所有方法中最慢，但有时候无法避免</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">copy</span>
<span class="n">new_list</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">old_list</span><span class="p">)</span>
</pre></div>


<p>例子：</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">copy</span>

<span class="n">class</span> <span class="n">Foo</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">:</span>
    <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">val</span><span class="p">)</span><span class="o">:</span>
         <span class="n">self</span><span class="p">.</span><span class="n">val</span> <span class="o">=</span> <span class="n">val</span>

    <span class="n">def</span> <span class="n">__repr__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">str</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">val</span><span class="p">)</span>

<span class="n">foo</span> <span class="o">=</span> <span class="n">Foo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="err">&#39;</span><span class="n">foo</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">foo</span><span class="p">]</span>
<span class="n">b</span> <span class="o">=</span> <span class="n">a</span><span class="p">[</span><span class="o">:</span><span class="p">]</span>
<span class="n">c</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>
<span class="n">e</span> <span class="o">=</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">a</span><span class="p">)</span>

<span class="cp"># edit orignal list and instance</span>
<span class="n">a</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="err">&#39;</span><span class="n">baz</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">foo</span><span class="p">.</span><span class="n">val</span> <span class="o">=</span> <span class="mi">5</span>

<span class="n">print</span> <span class="s">&quot;original: %r</span><span class="se">\n</span><span class="s"> slice: %r</span><span class="se">\n</span><span class="s"> list(): %r</span><span class="se">\n</span><span class="s"> copy: %r</span><span class="se">\n</span><span class="s"> deepcopy: %r&quot;</span> \
       <span class="o">%</span> <span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">e</span><span class="p">)</span>
</pre></div>


<p>结果:</p>
<div class="codehilite"><pre><span class="nl">original:</span> <span class="p">[</span><span class="err">&#39;</span><span class="n">foo</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">baz</span><span class="err">&#39;</span><span class="p">]</span>
<span class="nl">slice:</span> <span class="p">[</span><span class="err">&#39;</span><span class="n">foo</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="n">list</span><span class="p">()</span><span class="o">:</span> <span class="p">[</span><span class="err">&#39;</span><span class="n">foo</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="nl">copy:</span> <span class="p">[</span><span class="err">&#39;</span><span class="n">foo</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
<span class="nl">deepcopy:</span> <span class="p">[</span><span class="err">&#39;</span><span class="n">foo</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
</pre></div>


<p>效率简单比较</p>
<div class="codehilite"><pre><span class="mf">10.59</span> <span class="o">-</span> <span class="n">copy</span><span class="p">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="n">old_list</span><span class="p">)</span>
<span class="mf">10.16</span> <span class="o">-</span> <span class="n">pure</span> <span class="n">python</span> <span class="n">Copy</span><span class="p">()</span> <span class="n">method</span> <span class="n">copying</span> <span class="n">classes</span> <span class="n">with</span> <span class="n">deepcopy</span>
<span class="mf">1.488</span> <span class="o">-</span> <span class="n">pure</span> <span class="n">python</span> <span class="n">Copy</span><span class="p">()</span> <span class="n">method</span> <span class="n">not</span> <span class="n">copying</span> <span class="n">classes</span> <span class="p">(</span><span class="n">only</span> <span class="n">dicts</span><span class="o">/</span><span class="n">lists</span><span class="o">/</span><span class="n">tuples</span><span class="p">)</span>
<span class="mf">0.325</span> <span class="o">-</span> <span class="k">for</span> <span class="n">item</span> <span class="n">in</span> <span class="n">old_list</span><span class="o">:</span> <span class="n">new_list</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
<span class="mf">0.217</span> <span class="o">-</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">old_list</span><span class="p">]</span> <span class="p">(</span><span class="n">a</span> <span class="n">list</span> <span class="n">comprehension</span><span class="p">)</span>
<span class="mf">0.186</span> <span class="o">-</span> <span class="n">copy</span><span class="p">.</span><span class="n">copy</span><span class="p">(</span><span class="n">old_list</span><span class="p">)</span>
<span class="mf">0.075</span> <span class="o">-</span> <span class="n">list</span><span class="p">(</span><span class="n">old_list</span><span class="p">)</span>
<span class="mf">0.053</span> <span class="o">-</span> <span class="n">new_list</span> <span class="o">=</span> <span class="p">[];</span> <span class="n">new_list</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">old_list</span><span class="p">)</span>
<span class="mf">0.039</span> <span class="o">-</span> <span class="n">old_list</span><span class="p">[</span><span class="o">:</span><span class="p">]</span> <span class="p">(</span><span class="n">list</span> <span class="n">slicing</span><span class="p">)</span>
</pre></div>


<h3>列表的append和extend的区别</h3>
<p>问题 <a href="http://stackoverflow.com/questions/252703/python-append-vs-extend">链接</a></p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">append</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">extend</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]</span>
</pre></div>


<h3>如何随机地从列表中抽取变量</h3>
<p>问题 <a href="http://stackoverflow.com/questions/306400/how-do-i-randomly-select-an-item-from-a-list-using-python">链接</a></p>
<div class="codehilite"><pre><span class="n">foo</span> <span class="o">=</span> <span class="p">[</span><span class="sc">&#39;a&#39;</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="p">,</span> <span class="sc">&#39;c&#39;</span><span class="p">,</span> <span class="sc">&#39;d&#39;</span><span class="p">,</span> <span class="sc">&#39;e&#39;</span><span class="p">]</span>
<span class="n">from</span> <span class="n">random</span> <span class="n">import</span> <span class="n">choice</span>
<span class="n">print</span> <span class="n">choice</span><span class="p">(</span><span class="n">foo</span><span class="p">)</span>
</pre></div>


<h3>如何利用下标从列表中删除一个元素</h3>
<p>问题 <a href="http://stackoverflow.com/questions/627435/how-to-remove-an-element-from-a-list-by-index-in-python">链接</a></p>
<p>1.del</p>
<div class="codehilite"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">:</span> <span class="n">a</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">:</span> <span class="n">a</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">]</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">:</span> <span class="n">del</span> <span class="n">a</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">In</span> <span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">:</span> <span class="n">a</span>
<span class="n">Out</span><span class="p">[</span><span class="mi">12</span><span class="p">]</span><span class="o">:</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
</pre></div>


<p>2.pop</p>
<div class="codehilite"><pre><span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="sc">&#39;a&#39;</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="p">,</span> <span class="sc">&#39;c&#39;</span><span class="p">,</span> <span class="sc">&#39;d&#39;</span><span class="p">]</span>
<span class="n">a</span><span class="p">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="cp"># now a is [&#39;a&#39;, &#39;c&#39;, &#39;d&#39;]</span>

<span class="n">a</span> <span class="o">=</span> <span class="p">[</span><span class="sc">&#39;a&#39;</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="p">,</span> <span class="sc">&#39;c&#39;</span><span class="p">,</span> <span class="sc">&#39;d&#39;</span><span class="p">]</span>
<span class="n">a</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
<span class="cp"># now a is [&#39;a&#39;, &#39;b&#39;, &#39;c&#39;]</span>
</pre></div>


<h3>获取列表的最后一个元素</h3>
<p>问题 <a href="http://stackoverflow.com/questions/930397/how-to-get-the-last-element-of-a-list">链接</a></p>
<p>囧</p>
<div class="codehilite"><pre><span class="n">result</span> <span class="o">=</span> <span class="n">l</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">l</span><span class="p">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>


<h3>序列的切片操作</h3>
<p>问题 <a href="http://stackoverflow.com/questions/509211/the-python-slice-notation">链接</a></p>
<p>It's pretty simple really:
很简单:</p>
<div class="codehilite"><pre><span class="n">a</span><span class="p">[</span><span class="n">start</span><span class="o">:</span><span class="n">end</span><span class="p">]</span> <span class="err">#</span> <span class="n">start</span> <span class="err">到</span> <span class="n">end</span><span class="o">-</span><span class="mi">1</span>
<span class="n">a</span><span class="p">[</span><span class="n">start</span><span class="o">:</span><span class="p">]</span>    <span class="err">#</span> <span class="n">start</span> <span class="err">到</span> <span class="err">末尾</span>
<span class="n">a</span><span class="p">[</span><span class="o">:</span><span class="n">end</span><span class="p">]</span>      <span class="err">#</span> <span class="mi">0</span> <span class="err">到</span> <span class="n">end</span><span class="o">-</span><span class="mi">1</span>
<span class="n">a</span><span class="p">[</span><span class="o">:</span><span class="p">]</span>         <span class="err">#</span> <span class="err">整个列表的拷贝</span>
</pre></div>


<p>还有一个step变量，控制步长,可在上面语法中使用</p>
<div class="codehilite"><pre><span class="n">a</span><span class="p">[</span><span class="n">start</span><span class="o">:</span><span class="n">end</span><span class="o">:</span><span class="n">step</span><span class="p">]</span> <span class="err">#</span> <span class="n">start</span> <span class="n">through</span> <span class="n">not</span> <span class="n">past</span> <span class="n">end</span><span class="p">,</span> <span class="n">by</span> <span class="n">step</span>
</pre></div>


<p>注意，左闭右开</p>
<p>其他特点，开始或结束下标可能是负数，表示从序列末尾开始计算而非从头开始计算,所以</p>
<div class="codehilite"><pre><span class="s-Atom">a</span><span class="p">[</span><span class="o">-</span><span class="m">1</span><span class="p">]</span>    <span class="s-Atom">#</span> <span class="s-Atom">最后一个元素</span>
<span class="s-Atom">a</span><span class="p">[</span><span class="o">-</span><span class="m">2</span><span class="s-Atom">:</span><span class="p">]</span>   <span class="s-Atom">#</span> <span class="s-Atom">最后两个元素</span>
<span class="s-Atom">a</span><span class="p">[:-</span><span class="m">2</span><span class="p">]</span>   <span class="s-Atom">#</span> <span class="s-Atom">除了最后两个元素</span>
</pre></div>


<p>Python对程序员很友好，如果序列中存在的元素数量少于你要的，例如，你请求 a[:-2] 但是a只有一个元素，你会得到一个空列表，而不是一个错误.有时候你或许希望返回的是一个错误，所以你必须知道这点</p>
<h3>如何将一个列表切分成若干个长度相同的子序列</h3>
<p>问题 <a href="http://stackoverflow.com/questions/312443/how-do-you-split-a-list-into-evenly-sized-chunks-in-python">链接</a></p>
<p>想要得到这样的效果</p>
<div class="codehilite"><pre><span class="n">l</span> <span class="o">=</span> <span class="n">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">print</span> <span class="n">chunks</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="p">[</span> <span class="p">[</span> <span class="mf">1..10</span> <span class="p">],</span> <span class="p">[</span> <span class="mf">11..20</span> <span class="p">],</span> <span class="p">..,</span> <span class="p">[</span> <span class="mf">991..999</span> <span class="p">]</span> <span class="p">]</span>
</pre></div>


<p>使用yield:</p>
<div class="codehilite"><pre><span class="n">def</span> <span class="n">chunks</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span>
    <span class="s">&quot;&quot;&quot; Yield successive n-sized chunks from l.</span>
    <span class="s">&quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">xrange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span>
        <span class="n">yield</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="o">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]</span>
<span class="n">list</span><span class="p">(</span><span class="n">chunks</span><span class="p">(</span><span class="n">range</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">75</span><span class="p">),</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>


<p>直接处理</p>
<div class="codehilite"><pre><span class="n">def</span> <span class="n">chunks</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span><span class="o">:</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="o">:</span><span class="n">i</span><span class="o">+</span><span class="n">n</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="n">in</span> <span class="n">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">len</span><span class="p">(</span><span class="n">l</span><span class="p">),</span> <span class="n">n</span><span class="p">)]</span>
</pre></div>


<h3>使用列表解析创建一个字典</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1747817/python-create-a-dictionary-with-list-comprehension">链接</a></p>
<p>python 2.6</p>
<div class="codehilite"><pre><span class="n">d</span> <span class="o">=</span> <span class="n">dict</span><span class="p">((</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="n">in</span> <span class="n">sequence</span><span class="p">)</span>
</pre></div>


<p>python 2.7+ or 3, 使用 <a href="http://www.python.org/dev/peps/pep-0274/">字典解析语法</a></p>
<div class="codehilite"><pre><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="n">key</span><span class="o">:</span> <span class="n">value</span> <span class="k">for</span> <span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="n">in</span> <span class="n">sequence</span><span class="p">}</span>
</pre></div>


<h3>使用"in"还是"has_key()"</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1323410/has-key-or-in">链接</a></p>
<div class="codehilite"><pre><span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="sc">&#39;a&#39;</span> <span class="n">in</span> <span class="n">d</span>
<span class="n">True</span>
<span class="nl">or:</span>

<span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="n">d</span><span class="p">.</span><span class="n">has_key</span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="p">)</span>
<span class="n">True</span>
</pre></div>


<p>哪种更好</p>
<p>in更pythonic, 另外 has_key()在Python3.x中已经被移除</p>
<h3>字典默认值</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1602934/check-if-a-given-key-already-exists-in-a-dictionary">链接</a></p>
<p>和问题有点偏</p>
<div class="codehilite"><pre><span class="cp">#获取时,如不存在，得到默认值</span>
<span class="n">d</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="cp">#设置时，若key不存在，设置默认值，已存在，返回已存在value</span>
<span class="n">d</span><span class="p">.</span><span class="n">setdefault</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="p">[]).</span><span class="n">append</span><span class="p">(</span><span class="n">new_element</span><span class="p">)</span>
<span class="cp">#初始即默认值</span>
<span class="n">from</span> <span class="n">collections</span> <span class="n">import</span> <span class="n">defaultdict</span>
<span class="n">d</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="n">lambda</span><span class="o">:</span> <span class="mi">0</span><span class="p">)</span>
<span class="cp">#or d = defaultdict(int)</span>
</pre></div>


<h3>如何给字典添加一个值</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1024847/add-to-a-dictionary-in-python">链接</a></p>
<div class="codehilite"><pre><span class="cp">#### Making a dictionary ####</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
<span class="cp"># OR #</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dict</span><span class="p">()</span>

<span class="cp">#### Initially adding values ####</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span><span class="sc">&#39;b&#39;</span><span class="o">:</span><span class="mi">2</span><span class="p">,</span><span class="sc">&#39;c&#39;</span><span class="o">:</span><span class="mi">3</span><span class="p">}</span>
<span class="cp"># OR #</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="cp">#### Inserting/Updating value ####</span>
<span class="n">data</span><span class="p">[</span><span class="sc">&#39;a&#39;</span><span class="p">]</span><span class="o">=</span><span class="mi">1</span>  <span class="err">#</span> <span class="n">updates</span> <span class="k">if</span> <span class="sc">&#39;a&#39;</span> <span class="n">exists</span><span class="p">,</span> <span class="k">else</span> <span class="n">adds</span> <span class="sc">&#39;a&#39;</span>
<span class="cp"># OR #</span>
<span class="n">data</span><span class="p">.</span><span class="n">update</span><span class="p">({</span><span class="sc">&#39;a&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">})</span>
<span class="cp"># OR #</span>
<span class="n">data</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">dict</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>

<span class="cp">#### Merging 2 dictionaries ####</span>
<span class="n">data</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">data2</span><span class="p">)</span>  <span class="err">#</span> <span class="n">Where</span> <span class="n">data2</span> <span class="n">is</span> <span class="n">also</span> <span class="n">a</span> <span class="n">dict</span><span class="p">.</span>
</pre></div>


<h3>如何将字段转换成一个object，然后使用对象-属性的方式读取</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1305532/convert-python-dict-to-object">链接</a></p>
<p>有dict</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="p">{</span><span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">},</span> <span class="sc">&#39;d&#39;</span><span class="o">:</span> <span class="p">[</span><span class="s">&quot;hi&quot;</span><span class="p">,</span> <span class="p">{</span><span class="err">&#39;</span><span class="n">foo</span><span class="err">&#39;</span><span class="o">:</span> <span class="s">&quot;bar&quot;</span><span class="p">}]}}</span>
</pre></div>


<p>想用这种方式访问</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">dict2obj</span><span class="p">(</span><span class="n">d</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">a</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">b</span><span class="p">.</span><span class="n">c</span>
<span class="mi">2</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">foo</span>
<span class="n">bar</span>
</pre></div>


<p>使用namedtuple</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">from</span> <span class="n">collections</span> <span class="n">import</span> <span class="n">namedtuple</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">MyStruct</span> <span class="o">=</span> <span class="n">namedtuple</span><span class="p">(</span><span class="err">&#39;</span><span class="n">MyStruct</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">a</span> <span class="n">b</span> <span class="n">d</span><span class="err">&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">MyStruct</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="p">{</span><span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="err">&#39;</span><span class="n">hi</span><span class="err">&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span>
<span class="n">MyStruct</span><span class="p">(</span><span class="n">a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">b</span><span class="o">=</span><span class="p">{</span><span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">},</span> <span class="n">d</span><span class="o">=</span><span class="p">[</span><span class="err">&#39;</span><span class="n">hi</span><span class="err">&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="p">.</span><span class="n">a</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="p">.</span><span class="n">b</span>
<span class="p">{</span><span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="p">.</span><span class="n">c</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="p">.</span><span class="n">d</span>
<span class="p">[</span><span class="err">&#39;</span><span class="n">hi</span><span class="err">&#39;</span><span class="p">]</span>
</pre></div>


<p>使用类</p>
<div class="codehilite"><pre><span class="n">class</span> <span class="n">Struct</span><span class="o">:</span>
    <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="o">**</span><span class="n">entries</span><span class="p">)</span><span class="o">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">__dict__</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">args</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span> <span class="o">=</span> <span class="n">Struct</span><span class="p">(</span><span class="o">**</span><span class="n">args</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span>
<span class="o">&lt;</span><span class="n">__main__</span><span class="p">.</span><span class="n">Struct</span> <span class="n">instance</span> <span class="n">at</span> <span class="mh">0x01D6A738</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="p">.</span><span class="n">a</span>
<span class="mi">1</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">s</span><span class="p">.</span><span class="n">b</span>
<span class="mi">2</span>
</pre></div>


<h2>字符串，文件</h2>
<h3>字符如何转为小写</h3>
<p>问题 <a href="http://stackoverflow.com/questions/6797984/how-to-convert-string-to-lowercase-in-python">链接</a></p>
<div class="codehilite"><pre><span class="n">s</span> <span class="o">=</span> <span class="s">&quot;Kilometer&quot;</span>
<span class="n">print</span><span class="p">(</span><span class="n">s</span><span class="p">.</span><span class="n">lower</span><span class="p">())</span>
</pre></div>


<h3>如何创建不存在的目录结构</h3>
<p>问题 <a href="http://stackoverflow.com/questions/273192/python-best-way-to-create-directory-if-it-doesnt-exist-for-file-write">链接</a></p>
<div class="codehilite"><pre><span class="k">if</span> <span class="n">not</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">exists</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span><span class="o">:</span>
    <span class="n">os</span><span class="p">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">directory</span><span class="p">)</span>
</pre></div>


<p>需要注意的是，当目录在exists和makedirs两个函数调用之间被创建时，makedirs将抛出OSError</p>
<h3>如何拷贝一个文件</h3>
<p>问题 <a href="http://stackoverflow.com/questions/123198/how-do-i-copy-a-file-in-python">链接</a></p>
<p><a href="http://docs.python.org/2/library/shutil.html">shutil</a>模块</p>
<div class="codehilite"><pre><span class="n">copyfile</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">dst</span><span class="p">)</span>
</pre></div>


<p>将src文件内容拷贝到dst，目标文件夹必须可写，否则将抛出IOError异常</p>
<p>如果目标文件已存在，将被覆盖</p>
<p>另外特殊文件，想字符文件，块设备文件，无法用这个方法进行拷贝</p>
<p>src/dst是字符串</p>
<h3>字符串转为float/int</h3>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="s2">&quot;545.2222&quot;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">float</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span>
<span class="mf">545.2222</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">int</span><span class="p">(</span><span class="nx">a</span><span class="p">)</span>
<span class="nx">Traceback</span> <span class="p">(</span><span class="nx">most</span> <span class="nx">recent</span> <span class="nb">call</span> <span class="nb">last</span><span class="p">):</span>
<span class="nb">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="nb">line</span> <span class="mi">1</span><span class="p">,</span> <span class="k">in</span> <span class="o">&lt;</span><span class="nx">module</span><span class="o">&gt;</span>
<span class="nx">ValueError</span><span class="p">:</span> <span class="nx">invalid</span> <span class="nb">literal</span> <span class="nb">for</span> <span class="nx">int</span><span class="p">()</span> <span class="k">with</span> <span class="nx">base</span> <span class="mi">10</span><span class="p">:</span> <span class="s1">&#39;545.2222&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">int</span><span class="p">(</span><span class="nx">float</span><span class="p">(</span><span class="nx">a</span><span class="p">))</span>
<span class="mi">545</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">int</span><span class="p">(</span><span class="s1">&#39;544&#39;</span><span class="p">)</span>
<span class="mi">544</span>
</pre></div>


<p>另一种，用 <a href="http://docs.python.org/2/library/ast.html#ast.literal_eval">ast</a>模块</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">ast</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ast</span><span class="p">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="s">&quot;545.2222&quot;</span><span class="p">)</span>
<span class="mf">545.2222</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ast</span><span class="p">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="s">&quot;31&quot;</span><span class="p">)</span>
<span class="mi">31</span>
</pre></div>


<h3>如何反向输出一个字符串</h3>
<p>问题 <a href="http://stackoverflow.com/questions/931092/reverse-a-string-in-python">链接</a></p>
<p>做法</p>
<div class="codehilite"><pre><span class="s-Atom">&gt;&gt;&gt;</span> <span class="s-Atom">&#39;hello world&#39;</span><span class="p">[</span><span class="s-Atom">::-</span><span class="m">1</span><span class="p">]</span>
<span class="s-Atom">&#39;dlrow olleh&#39;</span>
</pre></div>


<h3>如何随机生成大写字母和数字组成的字符串</h3>
<div class="codehilite"><pre><span class="mi">6U1</span><span class="n">S75</span>
<span class="mi">4</span><span class="n">Z4UKK</span>
<span class="n">U911K4</span>
</pre></div>


<p>解决</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">string</span><span class="p">,</span> <span class="n">random</span>
<span class="err">&#39;&#39;</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">random</span><span class="p">.</span><span class="n">choice</span><span class="p">(</span><span class="n">string</span><span class="p">.</span><span class="n">ascii_uppercase</span> <span class="o">+</span> <span class="n">string</span><span class="p">.</span><span class="n">digits</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="n">in</span> <span class="n">range</span><span class="p">(</span><span class="n">N</span><span class="p">))</span>
</pre></div>


<h3>逐行读文件去除换行符(perl chomp line)</h3>
<p>问题 <a href="http://stackoverflow.com/questions/275018/how-can-i-remove-chomp-a-newline-in-python">链接</a>
类似问题 <a href="http://stackoverflow.com/questions/761804/trimming-a-string-in-python">链接</a></p>
<p>读一个文件，如何获取每一行内容（不包括换行符）</p>
<p>比较pythonic的做法:</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">text</span> <span class="o">=</span> <span class="s">&quot;line 1</span><span class="se">\n</span><span class="s">line 2</span><span class="se">\r\n</span><span class="s">line 3</span><span class="se">\n</span><span class="s">line 4&quot;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">text</span><span class="p">.</span><span class="n">splitlines</span><span class="p">()</span>
<span class="p">[</span><span class="err">&#39;</span><span class="n">line</span> <span class="mi">1</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">line</span> <span class="mi">2</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">line</span> <span class="mi">3</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">line</span> <span class="mi">4</span><span class="err">&#39;</span><span class="p">]</span>
</pre></div>


<p>用rstrip,(rstrip/lstrip/strip)</p>
<div class="codehilite"><pre><span class="cp">#去除了空白+换行</span>
<span class="o">&gt;&gt;&gt;</span> <span class="err">&#39;</span><span class="n">test</span> <span class="n">string</span> <span class="err">\</span><span class="n">n</span><span class="err">&#39;</span><span class="p">.</span><span class="n">rstrip</span><span class="p">()</span>
<span class="err">&#39;</span><span class="n">test</span> <span class="n">string</span><span class="err">&#39;</span>
<span class="cp">#只去换行</span>
<span class="o">&gt;&gt;&gt;</span> <span class="err">&#39;</span><span class="n">test</span> <span class="n">string</span> <span class="err">\</span><span class="n">n</span><span class="err">&#39;</span><span class="p">.</span><span class="n">rstrip</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">)</span>
<span class="err">&#39;</span><span class="n">test</span> <span class="n">string</span> <span class="err">&#39;</span>
<span class="cp">#更通用的做法，系统相关</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">os</span><span class="p">,</span> <span class="n">sys</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">sys</span><span class="p">.</span><span class="n">platform</span>
<span class="err">&#39;</span><span class="n">linux2</span><span class="err">&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="s">&quot;foo</span><span class="se">\r\n</span><span class="s">&quot;</span><span class="p">.</span><span class="n">rstrip</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">linesep</span><span class="p">)</span>
<span class="err">&#39;</span><span class="n">foo</span><span class="err">\</span><span class="n">r</span><span class="err">&#39;</span>
</pre></div>


<h3>python中字符串的contains</h3>
<p>问题 <a href="http://stackoverflow.com/questions/3437059/does-python-have-a-string-contains-method">链接</a></p>
<p>python中字符串判断contains</p>
<p>使用in关键字</p>
<div class="codehilite"><pre><span class="k">if</span> <span class="n">not</span> <span class="s">&quot;blah&quot;</span> <span class="n">in</span> <span class="n">somestring</span><span class="o">:</span> <span class="k">continue</span>
<span class="k">if</span> <span class="s">&quot;blah&quot;</span> <span class="n">not</span> <span class="n">in</span> <span class="n">somestring</span><span class="o">:</span> <span class="k">continue</span>
</pre></div>


<p>使用字符串的find/index  (注意index查找失败抛异常)</p>
<div class="codehilite"><pre><span class="n">s</span> <span class="o">=</span> <span class="s">&quot;This be a string&quot;</span>
<span class="k">if</span> <span class="n">s</span><span class="p">.</span><span class="n">find</span><span class="p">(</span><span class="s">&quot;is&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="o">:</span>
    <span class="n">print</span> <span class="s">&quot;No &#39;is&#39; here!&quot;</span>
<span class="nl">else:</span>
    <span class="n">print</span> <span class="s">&quot;Found &#39;is&#39; in the string.&quot;</span>
</pre></div>


<h3>如何判断一个字符串是数字</h3>
<p>问题 <a href="http://stackoverflow.com/questions/354038/how-do-i-check-if-a-string-is-a-number-in-python">链接</a></p>
<p>使用这种方法会不会十分丑陋和低效</p>
<div class="codehilite"><pre><span class="n">def</span> <span class="n">is_number</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="o">:</span>
    <span class="nl">try:</span>
        <span class="kt">float</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">True</span>
    <span class="n">except</span> <span class="n">ValueError</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">False</span>
</pre></div>


<p>使用这种方法并不丑陋和低效</p>
<p>使用isdigit(缺点，对非整数无能为力)</p>
<div class="codehilite"><pre><span class="n">a</span> <span class="o">=</span> <span class="s">&quot;03523&quot;</span>
<span class="n">a</span><span class="p">.</span><span class="n">isdigit</span><span class="p">()</span>
</pre></div>


<h3>如何填充0到数字字符串中保证统一长度</h3>
<p>问题 <a href="http://stackoverflow.com/questions/339007/python-nicest-way-to-pad-zeroes-to-string">链接</a></p>
<p>对于字符串</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="sc">&#39;4&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print</span> <span class="n">n</span><span class="p">.</span><span class="n">zfill</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="err">&#39;</span><span class="mo">004</span><span class="err">&#39;</span>
</pre></div>


<p>对于数字,<a href="http://docs.python.org/2/library/string.html#formatexamples">相关文档</a></p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print</span> <span class="err">&#39;</span><span class="o">%</span><span class="mo">03</span><span class="n">d</span><span class="err">&#39;</span> <span class="o">%</span> <span class="n">n</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mo">004</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print</span> <span class="s">&quot;{0:03d}&quot;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>  <span class="err">#</span> <span class="n">python</span> <span class="o">&gt;=</span> <span class="mf">2.6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mo">004</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print</span><span class="p">(</span><span class="s">&quot;{0:03d}&quot;</span><span class="p">.</span><span class="n">format</span><span class="p">(</span><span class="mi">4</span><span class="p">))</span>  <span class="err">#</span> <span class="n">python</span> <span class="mi">3</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mo">004</span>
</pre></div>


<h2>控制结构（条件、循环）</h2>
<h3>如何在循环中获取下标</h3>
<p>问题 <a href="http://stackoverflow.com/questions/522563/accessing-the-index-in-python-for-loops">链接</a></p>
<p>使用enumerate</p>
<div class="codehilite"><pre><span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">val</span> <span class="n">in</span> <span class="n">enumerate</span><span class="p">(</span><span class="n">ints</span><span class="p">)</span><span class="o">:</span>
    <span class="n">print</span> <span class="n">idx</span><span class="p">,</span> <span class="n">val</span>
</pre></div>


<h3>如何判断一个变量的类型</h3>
<p>问题 <a href="http://stackoverflow.com/questions/402504/how-to-determine-the-variable-type-in-python">链接</a></p>
<p>使用type</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">123</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">type</span> <span class="err">&#39;</span><span class="kt">int</span><span class="err">&#39;</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="n">is</span> <span class="kt">int</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">123456789L</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">type</span> <span class="err">&#39;</span><span class="kt">long</span><span class="err">&#39;</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="n">is</span> <span class="kt">long</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">i</span> <span class="o">=</span> <span class="mf">123.456</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="o">&lt;</span><span class="n">type</span> <span class="err">&#39;</span><span class="kt">float</span><span class="err">&#39;</span><span class="o">&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="n">is</span> <span class="kt">float</span>
<span class="n">True</span>
</pre></div>


<p>另外一个相同的问题  <a href="http://stackoverflow.com/questions/2225038/python-determine-the-type-of-an-object">链接</a></p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span> <span class="p">[]</span> <span class="p">)</span> <span class="o">==</span> <span class="n">list</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span> <span class="p">{}</span> <span class="p">)</span> <span class="o">==</span> <span class="n">dict</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span> <span class="s">&quot;&quot;</span> <span class="p">)</span> <span class="o">==</span> <span class="n">str</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span> <span class="mi">0</span> <span class="p">)</span> <span class="o">==</span> <span class="kt">int</span>
<span class="n">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">class</span> <span class="n">Test1</span> <span class="p">(</span> <span class="n">object</span> <span class="p">)</span><span class="o">:</span>
    <span class="n">pass</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">class</span> <span class="n">Test2</span> <span class="p">(</span> <span class="n">Test1</span> <span class="p">)</span><span class="o">:</span>
    <span class="n">pass</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="n">Test1</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="n">Test2</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span> <span class="n">a</span> <span class="p">)</span> <span class="o">==</span> <span class="n">Test1</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span> <span class="n">b</span> <span class="p">)</span> <span class="o">==</span> <span class="n">Test2</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">type</span><span class="p">(</span> <span class="n">b</span> <span class="p">)</span> <span class="o">==</span> <span class="n">Test1</span>
<span class="n">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">isinstance</span><span class="p">(</span> <span class="n">b</span><span class="p">,</span> <span class="n">Test1</span> <span class="p">)</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">isinstance</span><span class="p">(</span> <span class="n">b</span><span class="p">,</span> <span class="n">Test2</span> <span class="p">)</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">isinstance</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">Test1</span> <span class="p">)</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">isinstance</span><span class="p">(</span> <span class="n">a</span><span class="p">,</span> <span class="n">Test2</span> <span class="p">)</span>
<span class="n">False</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">isinstance</span><span class="p">(</span> <span class="p">[],</span> <span class="n">list</span> <span class="p">)</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">isinstance</span><span class="p">(</span> <span class="p">{},</span> <span class="n">dict</span> <span class="p">)</span>
<span class="n">True</span>
</pre></div>


<h2>类</h2>
<h3>如何判断一个对象是否拥有某个属性</h3>
<p>问题 <a href="http://stackoverflow.com/questions/610883/how-to-know-if-an-object-has-an-attribute-in-python">链接</a></p>
<div class="codehilite"><pre><span class="k">if</span> <span class="n">hasattr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">property</span><span class="err">&#39;</span><span class="p">)</span><span class="o">:</span>
    <span class="n">a</span><span class="p">.</span><span class="n">property</span>
</pre></div>


<p>两种风格</p>
<p>EAFP(easier to ask for forgiveness than permission)</p>
<p>LBYL(look before you leap)</p>
<p>相关内容
<a href="http://web.archive.org/web/20070929122422/http://mail.python.org/pipermail/python-list/2003-May/205182.html">EAFP vs LBYL (was Re: A little disappointed so far)</a>
<a href="http://python.net/~goodger/projects/pycon/2007/idiomatic/handout.html#eafp-vs-lbyl">EAFP vs. LBYL @Code Like a Pythonista: Idiomatic Python</a></p>
<div class="codehilite"><pre><span class="k">try</span><span class="o">:</span>
    <span class="n">doStuff</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">property</span><span class="o">)</span>
<span class="n">except</span> <span class="n">AttributeError</span><span class="o">:</span>
    <span class="n">otherStuff</span><span class="o">()</span>
<span class="n">or</span>

<span class="k">if</span> <span class="n">hasattr</span><span class="o">(</span><span class="n">a</span><span class="o">,</span> <span class="s1">&#39;property&#39;</span><span class="o">):</span>
    <span class="n">doStuff</span><span class="o">(</span><span class="n">a</span><span class="o">.</span><span class="na">property</span><span class="o">)</span>
<span class="k">else</span><span class="o">:</span>
    <span class="n">otherStuff</span><span class="o">()</span>
</pre></div>


<h3>Python中的类变量(环境变量)</h3>
<p>问题 <a href="http://stackoverflow.com/questions/68645/static-class-variables-in-python">链接</a></p>
<p>在类中定义的变量，不在方法定义中，成为类变量或静态变量</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">class</span> <span class="n">MyClass</span><span class="o">:</span>
<span class="p">...</span>     <span class="n">i</span> <span class="o">=</span> <span class="mi">3</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">MyClass</span><span class="p">.</span><span class="n">i</span>
<span class="mi">3</span>
</pre></div>


<p>i是类级别的变量，但这里要和实例级别的变量i区分开</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">m</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">m</span><span class="p">.</span><span class="n">i</span> <span class="o">=</span> <span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">MyClass</span><span class="p">.</span><span class="n">i</span><span class="p">,</span> <span class="n">m</span><span class="p">.</span><span class="n">i</span>
<span class="o">&gt;&gt;&gt;</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>
</pre></div>


<p>这和C++/java完全不同，但和C#区别不大，C#不允许类实例获取静态变量</p>
<p>具体见 <a href="http://docs.python.org/2/tutorial/classes.html#SECTION0011320000000000000000">what the Python tutorial has to say on the subject of classes and class objects</a></p>
<p>另外，静态方法</p>
<div class="codehilite"><pre><span class="n">class</span> <span class="n">C</span><span class="o">:</span>
    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">f</span><span class="p">(</span><span class="n">arg1</span><span class="p">,</span> <span class="n">arg2</span><span class="p">,</span> <span class="p">...)</span><span class="o">:</span> <span class="p">...</span>
</pre></div>


<h3>如何定义静态方法(static method)</h3>
<p>问题 <a href="http://stackoverflow.com/questions/735975/static-methods-in-python">链接</a></p>
<p>使用 <a href="http://docs.python.org/2/library/functions.html#staticmethod">staticmethod</a>装饰器</p>
<div class="codehilite"><pre><span class="n">class</span> <span class="n">MyClass</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">:</span>
    <span class="err">@</span><span class="n">staticmethod</span>
    <span class="n">def</span> <span class="n">the_static_method</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">:</span>
        <span class="n">print</span> <span class="n">x</span>
<span class="n">MyClass</span><span class="p">.</span><span class="n">the_static_method</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="err">#</span> <span class="n">outputs</span> <span class="mi">2</span>
</pre></div>


<h3>@staticmethod和@classmethod的区别</h3>
<p>问题 <a href="http://stackoverflow.com/questions/136097/what-is-the-difference-between-staticmethod-and-classmethod-in-python">链接</a></p>
<p>staticmethod，静态方法在调用时，对类及实例一无所知</p>
<p>仅仅是获取传递过来的参数，没有隐含的第一个参数，在Python里基本上用处不大，你完全可以用一个模块函数替换它</p>
<p>classmethod, 在调用时，将会获取到其所在的类，或者类实例，作为其第一个参数</p>
<p>当你想将函数作为一个类工厂时，这非常有用: 第一个参数是类，你可以实例化出对应实例对象，甚至子类对象。</p>
<p>可以观察下 dict.fromkey(),是一个类方法，当子类调用时，返回子类的实例</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">class</span> <span class="n">DictSubclass</span><span class="p">(</span><span class="n">dict</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>     <span class="n">def</span> <span class="n">__repr__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>         <span class="k">return</span> <span class="s">&quot;DictSubclass&quot;</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dict</span><span class="p">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">)</span>
<span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="n">None</span><span class="p">,</span> <span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="n">None</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="n">None</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">DictSubclass</span><span class="p">.</span><span class="n">fromkeys</span><span class="p">(</span><span class="s">&quot;abc&quot;</span><span class="p">)</span>
<span class="n">DictSubclass</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>


<h3>如何获取一个实例的类名</h3>
<p>问题 <a href="http://stackoverflow.com/questions/510972/getting-the-class-name-of-an-instance-in-python">链接</a></p>
<div class="codehilite"><pre><span class="n">x</span><span class="p">.</span><span class="n">__class__</span><span class="p">.</span><span class="n">__name__</span>
</pre></div>


<h2>模块</h2>
<h3>如何列出一个目录的所有文件</h3>
<p>问题 <a href="http://stackoverflow.com/questions/3207219/how-to-list-all-files-of-a-directory-in-python">链接</a></p>
<p>1.使用os.listdir(),得到目录下的所有文件和文件夹</p>
<div class="codehilite"><pre><span class="cp">#只需要文件</span>
<span class="n">from</span> <span class="n">os</span> <span class="n">import</span> <span class="n">listdir</span>
<span class="n">from</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span> <span class="n">import</span> <span class="n">isfile</span><span class="p">,</span> <span class="n">join</span>
<span class="n">onlyfiles</span> <span class="o">=</span> <span class="p">[</span> <span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="n">in</span> <span class="n">listdir</span><span class="p">(</span><span class="n">mypath</span><span class="p">)</span> <span class="k">if</span> <span class="n">isfile</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">mypath</span><span class="p">,</span><span class="n">f</span><span class="p">))</span> <span class="p">]</span>
</pre></div>


<p>2.os.walk()</p>
<div class="codehilite"><pre><span class="n">from</span> <span class="n">os</span> <span class="n">import</span> <span class="n">walk</span>

<span class="n">f</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="p">(</span><span class="n">dirpath</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span><span class="p">)</span> <span class="n">in</span> <span class="n">walk</span><span class="p">(</span><span class="n">mypath</span><span class="p">)</span><span class="o">:</span>
    <span class="n">f</span><span class="p">.</span><span class="n">extend</span><span class="p">(</span><span class="n">filenames</span><span class="p">)</span>
    <span class="k">break</span>
</pre></div>


<p>3.glob</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">glob</span>
<span class="n">print</span> <span class="n">glob</span><span class="p">.</span><span class="n">glob</span><span class="p">(</span><span class="s">&quot;/home/adam/*.txt&quot;</span><span class="p">)</span>
</pre></div>


<p>重复问题 <a href="http://stackoverflow.com/questions/120656/directory-listing-in-python">链接</a></p>
<p>import os</p>
<div class="codehilite"><pre><span class="k">for</span> <span class="n">dirname</span><span class="p">,</span> <span class="n">dirnames</span><span class="p">,</span> <span class="n">filenames</span> <span class="n">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="sc">&#39;.&#39;</span><span class="p">)</span><span class="o">:</span>
    <span class="err">#</span> <span class="n">print</span> <span class="n">path</span> <span class="n">to</span> <span class="n">all</span> <span class="n">subdirectories</span> <span class="n">first</span><span class="p">.</span>
    <span class="k">for</span> <span class="n">subdirname</span> <span class="n">in</span> <span class="n">dirnames</span><span class="o">:</span>
        <span class="n">print</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">subdirname</span><span class="p">)</span>

    <span class="err">#</span> <span class="n">print</span> <span class="n">path</span> <span class="n">to</span> <span class="n">all</span> <span class="n">filenames</span><span class="p">.</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="n">in</span> <span class="n">filenames</span><span class="o">:</span>
        <span class="n">print</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">dirname</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
</pre></div>


<h3>json和simplejson的区别</h3>
<p>问题 <a href="http://stackoverflow.com/questions/712791/json-and-simplejson-module-differences-in-python">链接</a></p>
<p>json就是simple，加入到标准库. json在2.6加入，simplejson在2.4+,2.6+,更有优势</p>
<p>另外，simplejson更新频率更高，如果你想使用最新版本，建议用simplejson</p>
<p>好的做法是</p>
<div class="codehilite"><pre><span class="k">try</span><span class="o">:</span> <span class="k">import</span> <span class="nn">simplejson</span> <span class="k">as</span> <span class="n">json</span>
<span class="n">except</span> <span class="n">ImportError</span><span class="o">:</span> <span class="k">import</span> <span class="nn">json</span>
</pre></div>


<p>另外,可以关注二者性能上的比较</p>
<h3>python中如何获取当前时间</h3>
<p>问题 <a href="http://stackoverflow.com/questions/415511/how-to-get-current-time-in-python">链接</a></p>
<p>时间日期</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">datetime</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">()</span>
<span class="n">datetime</span><span class="p">(</span><span class="mi">2009</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">78915</span><span class="p">)</span>
</pre></div>


<p>如果仅获取时间</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">time</span><span class="p">(</span><span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">())</span>
<span class="n">datetime</span><span class="p">.</span><span class="n">time</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">78915</span><span class="p">))</span>
<span class="cp">#等价</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">datetime</span><span class="p">.</span><span class="n">datetime</span><span class="p">.</span><span class="n">now</span><span class="p">().</span><span class="n">time</span><span class="p">()</span>
</pre></div>


<p>可以从文档中获取更多 <a href="http://docs.python.org/2/library/datetime.html">文档</a></p>
<p>如果想避免额外的datetime.</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">from</span> <span class="n">datetime</span> <span class="n">import</span> <span class="n">datetime</span>
</pre></div>


<h2>其他</h2>
<h3>如何从标准输入读取内容stdin</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1450393/how-do-you-read-from-stdin-in-python">链接</a></p>
<p>使用<a href="http://docs.python.org/2/library/fileinput.html">fileinput</a></p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">fileinput</span>
<span class="k">for</span> <span class="n">line</span> <span class="n">in</span> <span class="n">fileinput</span><span class="p">.</span><span class="n">input</span><span class="p">()</span><span class="o">:</span>
    <span class="n">pass</span>
</pre></div>


<h3>foo is None 和 foo == None的区别</h3>
<p>问题 <a href="http://stackoverflow.com/questions/26595/is-there-any-difference-between-foo-is-none-and-foo-none">链接</a></p>
<div class="codehilite"><pre><span class="k">if</span> <span class="n">foo</span> <span class="n">is</span> <span class="n">None</span><span class="o">:</span> <span class="n">pass</span>
<span class="k">if</span> <span class="n">foo</span> <span class="o">==</span> <span class="n">None</span><span class="o">:</span> <span class="n">pass</span>
</pre></div>


<p>如果比较相同的对象实例，is总是返回True
而 == 最终取决于 "<strong>eq</strong>()"</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">class</span> <span class="n">foo</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">:</span>
    <span class="n">def</span> <span class="n">__eq__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">other</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">True</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">=</span> <span class="n">foo</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="o">==</span> <span class="n">None</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">f</span> <span class="n">is</span> <span class="n">None</span>
<span class="n">False</span>

<span class="o">&gt;&gt;&gt;</span> <span class="n">list1</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">list2</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">list1</span><span class="o">==</span><span class="n">list2</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">list1</span> <span class="n">is</span> <span class="n">list2</span>
<span class="n">False</span>
</pre></div>


<p>另外</p>
<div class="codehilite"><pre><span class="p">(</span><span class="n">ob1</span> <span class="n">is</span> <span class="n">ob2</span><span class="p">)</span> <span class="err">等价于</span> <span class="p">(</span><span class="n">id</span><span class="p">(</span><span class="n">ob1</span><span class="p">)</span> <span class="o">==</span> <span class="n">id</span><span class="p">(</span><span class="n">ob2</span><span class="p">))</span>
</pre></div>


<h3>__init__.py是做什么用的</h3>
<p>问题 <a href="http://stackoverflow.com/questions/448271/what-is-init-py-for">链接</a></p>
<p>这是包的一部分，<a href="http://docs.python.org/2/tutorial/modules.html#packages">具体文档</a></p>
<p>__init__.py让Python把目录当成包，</p>
<p>最简单的例子，__init__.py仅是一个空文件，但它可以一样执行包初始化代码或者设置__all__变量，后续说明</p>
<h3>如何获取安装的python模块列表</h3>
<p>问题 <a href="http://stackoverflow.com/questions/739993/get-a-list-of-installed-python-modules">链接</a></p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">help</span><span class="p">(</span><span class="err">&#39;</span><span class="n">modules</span><span class="err">&#39;</span><span class="p">)</span>
</pre></div>


<h2>环境相关</h2>
<h3>setup.py安装后如何卸载</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1550226/python-setup-py-uninstall">链接</a></p>
<p>使用下面命令安装的包如何卸载</p>
<div class="codehilite"><pre><span class="n">python</span> <span class="n">setup</span><span class="p">.</span><span class="n">py</span> <span class="n">install</span>
</pre></div>


<p>手工删除的话</p>
<div class="codehilite"><pre><span class="n">python</span> <span class="n">setup</span><span class="p">.</span><span class="n">py</span> <span class="n">install</span> <span class="o">--</span><span class="n">record</span> <span class="n">files</span><span class="p">.</span><span class="n">txt</span>
<span class="n">cat</span> <span class="n">files</span><span class="p">.</span><span class="n">txt</span> <span class="o">|</span> <span class="n">xargs</span> <span class="n">rm</span> <span class="o">-</span><span class="n">rf</span>
</pre></div>


<h2>异常</h2>
<h3>如何一行内处理多个异常</h3>
<p>问题 <a href="http://stackoverflow.com/questions/6470428/catch-multiple-exceptions-in-one-line-except-block">链接</a></p>
<p>我知道可以这么做</p>
<div class="codehilite"><pre><span class="nl">try:</span>
    <span class="err">#</span> <span class="k">do</span> <span class="n">something</span> <span class="n">that</span> <span class="n">may</span> <span class="n">fail</span>
<span class="nl">except:</span>
    <span class="err">#</span> <span class="k">do</span> <span class="n">this</span> <span class="k">if</span> <span class="n">ANYTHING</span> <span class="n">goes</span> <span class="n">wrong</span>
</pre></div>


<p>也可以</p>
<div class="codehilite"><pre><span class="nl">try:</span>
    <span class="err">#</span> <span class="k">do</span> <span class="n">something</span> <span class="n">that</span> <span class="n">may</span> <span class="n">fail</span>
<span class="n">except</span> <span class="n">IDontLikeYourFaceException</span><span class="o">:</span>
    <span class="err">#</span> <span class="n">put</span> <span class="n">on</span> <span class="n">makeup</span> <span class="n">or</span> <span class="n">smile</span>
<span class="n">except</span> <span class="n">YouAreTooShortException</span><span class="o">:</span>
    <span class="err">#</span> <span class="n">stand</span> <span class="n">on</span> <span class="n">a</span> <span class="n">ladder</span>
</pre></div>


<p>如果想在一行里处理多个异常的话</p>
<div class="codehilite"><pre><span class="nl">try:</span>
    <span class="err">#</span> <span class="k">do</span> <span class="n">something</span> <span class="n">that</span> <span class="n">may</span> <span class="n">fail</span>
<span class="n">except</span> <span class="n">IDontLIkeYouException</span><span class="p">,</span> <span class="n">YouAreBeingMeanException</span><span class="o">:</span> <span class="err">#没生效</span>
<span class="n">except</span> <span class="n">Exception</span><span class="p">,</span> <span class="n">e</span><span class="o">:</span> <span class="err">#捕获了所有</span>
    <span class="err">#</span> <span class="n">say</span> <span class="n">please</span>
</pre></div>


<p>答案</p>
<div class="codehilite"><pre><span class="cp"># as在python2.6,python2.7中仍然可以使用</span>
<span class="n">except</span> <span class="p">(</span><span class="n">IDontLIkeYouException</span><span class="p">,</span> <span class="n">YouAreBeingMeanException</span><span class="p">)</span> <span class="n">as</span> <span class="n">e</span><span class="o">:</span>
    <span class="n">pass</span>
</pre></div>


<h3>如何flush Python的print输出</h3>
<p>问题 <a href="http://stackoverflow.com/questions/230751/how-to-flush-output-of-python-print">链接</a>
重复问题 <a href="http://stackoverflow.com/questions/107705/python-output-buffering">链接</a></p>
<p>默认print输出到sys.stdout</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">sys</span>
<span class="n">sys</span><span class="p">.</span><span class="n">stdout</span><span class="p">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>


<p>参考
<a href="http://docs.python.org/2/reference/simple_stmts.html#the-print-statement">http://docs.python.org/reference/simple_stmts.html#the-print-statement</a>
<a href="http://docs.python.org/2/library/sys.html">http://docs.python.org/library/sys.html</a>
<a href="http://docs.python.org/2/library/stdtypes.html#file-objects">http://docs.python.org/library/stdtypes.html#file-objects</a></p>
<h3>如何获取一个函数的函数名字符串</h3>
<p>问题 <a href="http://stackoverflow.com/questions/251464/how-to-get-the-function-name-as-string-in-python">链接</a></p>
<div class="codehilite"><pre><span class="nx">my_function</span><span class="p">.</span><span class="nx">__name__</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kr">import</span> <span class="nx">time</span>
<span class="o">&gt;&gt;&gt;</span> <span class="nx">time</span><span class="p">.</span><span class="nx">time</span><span class="p">.</span><span class="nx">__name__</span>
<span class="s1">&#39;time&#39;</span>
</pre></div>


<h3>应该在学习Python3之前学习Python2，还是直接学习Python3</h3>
<p>问题 <a href="http://stackoverflow.com/questions/170921/should-i-learn-python-2-before-3-or-start-directly-from-python-3">链接</a></p>
<p>你可以从python2开始，2和3主要的语法格式和风格相同</p>
<p>3要替代2不是短时间内能完成的，将会是一个很长的过程，所以学习Python2并没有什么坏处</p>
<p>我建议你关注下2和3的不同之处  <a href="http://stackoverflow.com/questions/170921/should-i-learn-python-2-before-3-or-start-directly-from-python-3">This slides gives you a quick introduction of the changes in Python 2 and 3</a></p>
<h3>python中用==比较字符串，is有时候会返回错误判断</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1504717/python-vs-is-comparing-strings-is-fails-sometimes-why">链接</a></p>
<p>is是身份测试，==是相等测试</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="err">&#39;</span><span class="n">pub</span><span class="err">&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="err">&#39;&#39;</span><span class="p">.</span><span class="n">join</span><span class="p">([</span><span class="sc">&#39;p&#39;</span><span class="p">,</span> <span class="sc">&#39;u&#39;</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="p">])</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">==</span> <span class="n">b</span>
<span class="n">True</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="n">is</span> <span class="n">b</span>
<span class="n">False</span><span class="err">&#39;</span>
</pre></div>


<p>is 等价于 id(a) == id(b)</p>
<h3>如何截取一个字符串获得子串</h3>
<p>问题 <a href="http://stackoverflow.com/questions/663171/is-there-a-way-to-substring-a-string-in-python">链接</a></p>
<div class="codehilite"><pre><span class="s-Atom">&gt;&gt;&gt;</span> <span class="s-Atom">x</span> <span class="o">=</span> <span class="s2">&quot;Hello World!&quot;</span>
<span class="s-Atom">&gt;&gt;&gt;</span> <span class="s-Atom">x</span><span class="p">[</span><span class="m">2</span><span class="s-Atom">:</span><span class="p">]</span>
<span class="s-Atom">&#39;llo World!&#39;</span>
<span class="s-Atom">&gt;&gt;&gt;</span> <span class="s-Atom">x</span><span class="p">[</span><span class="s-Atom">:</span><span class="m">2</span><span class="p">]</span>
<span class="s-Atom">&#39;He&#39;</span>
<span class="s-Atom">&gt;&gt;&gt;</span> <span class="s-Atom">x</span><span class="p">[:-</span><span class="m">2</span><span class="p">]</span>
<span class="s-Atom">&#39;Hello Worl&#39;</span>
<span class="s-Atom">&gt;&gt;&gt;</span> <span class="s-Atom">x</span><span class="p">[</span><span class="o">-</span><span class="m">2</span><span class="s-Atom">:</span><span class="p">]</span>
<span class="s-Atom">&#39;d!&#39;</span>
<span class="s-Atom">&gt;&gt;&gt;</span> <span class="s-Atom">x</span><span class="p">[</span><span class="m">2</span><span class="p">:-</span><span class="m">2</span><span class="p">]</span>
<span class="s-Atom">&#39;llo Worl&#39;</span>
</pre></div>


<p>python将这类操作称为切片，可以作用于序列类型，不仅仅是字符串</p>
<h3>用函数名字符串调用一个函数</h3>
<p>问题 <a href="http://stackoverflow.com/questions/3061/calling-a-function-from-a-string-with-the-functions-name-in-python">链接</a></p>
<p>假设模块foo有函数bar:</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">foo</span>
<span class="n">methodToCall</span> <span class="o">=</span> <span class="n">getattr</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">bar</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">methodToCall</span><span class="p">()</span>
</pre></div>


<p>或者一行搞定</p>
<div class="codehilite"><pre><span class="n">result</span> <span class="o">=</span> <span class="n">getattr</span><span class="p">(</span><span class="n">foo</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">bar</span><span class="err">&#39;</span><span class="p">)()</span>
</pre></div>


<h3>如何获取文件扩展名</h3>
<p>问题 <a href="http://stackoverflow.com/questions/541390/extracting-extension-from-filename-in-python">链接</a></p>
<p>使用os.path.splitext方法：</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">os</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fileName</span><span class="p">,</span> <span class="n">fileExtension</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">splitext</span><span class="p">(</span><span class="err">&#39;</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">somefile</span><span class="p">.</span><span class="n">ext</span><span class="err">&#39;</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fileName</span>
<span class="err">&#39;</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">somefile</span><span class="err">&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">fileExtension</span>
<span class="err">&#39;</span><span class="p">.</span><span class="n">ext</span><span class="err">&#39;</span>
</pre></div>


<h3>如何获取list中包含某个元素所在的下标</h3>
<p>问题 <a href="http://stackoverflow.com/questions/176918/in-python-how-do-i-find-the-index-of-an-item-given-a-list-containing-it">链接</a></p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="p">[</span><span class="s">&quot;foo&quot;</span><span class="p">,</span><span class="s">&quot;bar&quot;</span><span class="p">,</span><span class="s">&quot;baz&quot;</span><span class="p">].</span><span class="n">index</span><span class="p">(</span><span class="err">&#39;</span><span class="n">bar</span><span class="err">&#39;</span><span class="p">)</span>
<span class="mi">1</span>
</pre></div>


<p>参照 <a href="http://docs.python.org/2/tutorial/datastructures.html#more-on-lists">文档</a></p>
<h3>如何截掉空格（包括tab)</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1185524/how-to-trim-whitespace-including-tabs">链接</a></p>
<p>空白在字符串左右两边</p>
<div class="codehilite"><pre><span class="n">s</span> <span class="o">=</span> <span class="s">&quot;  </span><span class="se">\t</span><span class="s"> a string example</span><span class="se">\t</span><span class="s">  &quot;</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">strip</span><span class="p">()</span>
</pre></div>


<p>空白在字符串右边</p>
<div class="codehilite"><pre><span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">rstrip</span><span class="p">()</span>
</pre></div>


<p>左边</p>
<div class="codehilite"><pre><span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">lstrip</span><span class="p">()</span>
</pre></div>


<p>另外你可以指定要截掉的字符作为参数</p>
<div class="codehilite"><pre><span class="n">s</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="n">strip</span><span class="p">(</span><span class="err">&#39;</span> <span class="err">\</span><span class="n">t</span><span class="err">\</span><span class="n">n</span><span class="err">\</span><span class="n">r</span><span class="err">&#39;</span><span class="p">)</span>
</pre></div>


<h3>如何将一个十六进制字符串转为整数</h3>
<p>问题 <a href="http://stackoverflow.com/questions/209513/convert-hex-string-to-int-in-python">链接</a></p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="kt">int</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="mi">10</span>
<span class="o">&gt;&gt;&gt;</span> <span class="kt">int</span><span class="p">(</span><span class="s">&quot;0xa&quot;</span><span class="p">,</span><span class="mi">16</span><span class="p">)</span>
<span class="mi">10</span>
</pre></div>


<h3>如何结束退出一个python脚本</h3>
<p>问题 <a href="http://stackoverflow.com/questions/73663/terminating-a-python-script">链接</a></p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">sys</span>
<span class="n">sys</span><span class="p">.</span><span class="n">exit</span><span class="p">()</span>
</pre></div>


<p>详细 <a href="http://docs.python.org/2/library/sys.html">文档</a></p>
<h3>如何往文件中追加文本</h3>
<p>问题 <a href="http://stackoverflow.com/questions/4706499/how-do-you-append-to-file-in-python">链接</a></p>
<div class="codehilite"><pre><span class="n">with</span> <span class="n">open</span><span class="p">(</span><span class="s">&quot;test.txt&quot;</span><span class="p">,</span> <span class="s">&quot;a&quot;</span><span class="p">)</span> <span class="n">as</span> <span class="n">myfile</span><span class="o">:</span>
    <span class="n">myfile</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="s">&quot;appended text&quot;</span><span class="p">)</span>
</pre></div>


<p>可以使用'a'或'a+b' mode打开文件，见 <a href="http://docs.python.org/2/library/functions.html#open">文档</a></p>
<h3>如何使用不同分隔符切分字符串</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1059559/python-strings-split-with-multiple-separators">链接</a></p>
<p>使用re.split  <a href="http://docs.python.org/2/library/re.html#re.split">文档</a></p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="err">&#39;\</span><span class="n">W</span><span class="o">+</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">Words</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">words</span><span class="p">.</span><span class="err">&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="err">&#39;</span><span class="n">Words</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">words</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">words</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="err">&#39;</span><span class="p">(</span><span class="err">\</span><span class="n">W</span><span class="o">+</span><span class="p">)</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">Words</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">words</span><span class="p">.</span><span class="err">&#39;</span><span class="p">)</span>
<span class="p">[</span><span class="err">&#39;</span><span class="n">Words</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">words</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">words</span><span class="err">&#39;</span><span class="p">,</span> <span class="sc">&#39;.&#39;</span><span class="p">,</span> <span class="err">&#39;&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">re</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="err">&#39;\</span><span class="n">W</span><span class="o">+</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">Words</span><span class="p">,</span> <span class="n">words</span><span class="p">,</span> <span class="n">words</span><span class="p">.</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="p">[</span><span class="err">&#39;</span><span class="n">Words</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">words</span><span class="p">,</span> <span class="n">words</span><span class="p">.</span><span class="err">&#39;</span><span class="p">])</span>
</pre></div>


<p>或者匹配获取正确的 re.findall</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">re</span>
<span class="n">DATA</span> <span class="o">=</span> <span class="s">&quot;Hey, you - what are you doing here!?&quot;</span>
<span class="n">print</span> <span class="n">re</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="n">r</span><span class="s">&quot;[\w&#39;]+&quot;</span><span class="p">,</span> <span class="n">DATA</span><span class="p">)</span>
<span class="cp"># Prints [&#39;Hey&#39;, &#39;you&#39;, &#39;what&#39;, &#39;are&#39;, &#39;you&#39;, &#39;doing&#39;, &#39;here&#39;]</span>
</pre></div>


<h3>如何获取一个字符的ASCII码</h3>
<p>问题 <a href="http://stackoverflow.com/questions/227459/ascii-value-of-a-character-in-python">链接</a></p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">ord</span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="p">)</span>
<span class="mi">97</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">chr</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>
<span class="sc">&#39;a&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">chr</span><span class="p">(</span><span class="n">ord</span><span class="p">(</span><span class="sc">&#39;a&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="mi">3</span><span class="p">)</span>
<span class="sc">&#39;d&#39;</span>
<span class="o">&gt;&gt;&gt;</span>
</pre></div>


<p>另外对于unicode</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">unichr</span><span class="p">(</span><span class="mi">97</span><span class="p">)</span>
<span class="n">u</span><span class="sc">&#39;a&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">unichr</span><span class="p">(</span><span class="mi">1234</span><span class="p">)</span>
<span class="n">u</span><span class="err">&#39;\</span><span class="n">u04d2</span><span class="err">&#39;</span>
</pre></div>


<h3>排序一个列表中的所有dict，根据dict内值</h3>
<p>问题 <a href="http://stackoverflow.com/questions/72899/in-python-how-do-i-sort-a-list-of-dictionaries-by-values-of-the-dictionary">链接</a></p>
<p>如何排序如下列表，根据name或age</p>
<div class="codehilite"><pre><span class="p">[{</span><span class="err">&#39;</span><span class="n">name</span><span class="sc">&#39;:&#39;</span><span class="n">Homer</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">age</span><span class="err">&#39;</span><span class="o">:</span><span class="mi">39</span><span class="p">},</span> <span class="p">{</span><span class="err">&#39;</span><span class="n">name</span><span class="sc">&#39;:&#39;</span><span class="n">Bart</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">age</span><span class="err">&#39;</span><span class="o">:</span><span class="mi">10</span><span class="p">}]</span>
</pre></div>


<p>简单的做法；</p>
<div class="codehilite"><pre><span class="n">newlist</span> <span class="o">=</span> <span class="n">sorted</span><span class="p">(</span><span class="n">list_to_be_sorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">lambda</span> <span class="n">k</span><span class="o">:</span> <span class="n">k</span><span class="p">[</span><span class="err">&#39;</span><span class="n">name</span><span class="err">&#39;</span><span class="p">])</span>
</pre></div>


<p>高效的做法</p>
<div class="codehilite"><pre><span class="n">from</span> <span class="n">operator</span> <span class="n">import</span> <span class="n">itemgetter</span>
<span class="n">newlist</span> <span class="o">=</span> <span class="n">sorted</span><span class="p">(</span><span class="n">list_to_be_sorted</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">itemgetter</span><span class="p">(</span><span class="err">&#39;</span><span class="n">name</span><span class="err">&#39;</span><span class="p">))</span>
</pre></div>


<h3>读文件到列表中</h3>
<p>问题 <a href="http://stackoverflow.com/questions/3277503/python-read-file-line-by-line-into-array">链接</a></p>
<div class="codehilite"><pre><span class="n">f</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="err">&#39;</span><span class="n">filename</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">lines</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">readlines</span><span class="p">()</span>
<span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
<span class="err">等价</span>
<span class="n">with</span> <span class="n">open</span><span class="p">(</span><span class="n">fname</span><span class="p">)</span> <span class="n">as</span> <span class="n">f</span><span class="o">:</span>
    <span class="n">content</span> <span class="o">=</span> <span class="n">f</span><span class="p">.</span><span class="n">readlines</span><span class="p">()</span>
</pre></div>


<p><a href="http://docs.python.org/2/tutorial/inputoutput.html#reading-and-writing-files">文档</a></p>
<h3>如何用http下载一个文件</h3>
<p>问题 <a href="http://stackoverflow.com/questions/22676/how-do-i-download-a-file-over-http-using-python">链接</a></p>
<p>直接使用urllib</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">urllib</span>
<span class="n">urllib</span><span class="p">.</span><span class="n">urlretrieve</span> <span class="p">(</span><span class="s">&quot;http://www.example.com/songs/mp3.mp3&quot;</span><span class="p">,</span> <span class="s">&quot;mp3.mp3&quot;</span><span class="p">)</span>
</pre></div>


<p>使用urllib2,并提供一个进度条</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">urllib2</span>

<span class="n">url</span> <span class="o">=</span> <span class="s">&quot;http://download.thinkbroadband.com/10MB.zip&quot;</span>

<span class="n">file_name</span> <span class="o">=</span> <span class="n">url</span><span class="p">.</span><span class="n">split</span><span class="p">(</span><span class="sc">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">urllib2</span><span class="p">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="n">f</span> <span class="o">=</span> <span class="n">open</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">wb</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">meta</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">info</span><span class="p">()</span>
<span class="n">file_size</span> <span class="o">=</span> <span class="kt">int</span><span class="p">(</span><span class="n">meta</span><span class="p">.</span><span class="n">getheaders</span><span class="p">(</span><span class="s">&quot;Content-Length&quot;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">print</span> <span class="s">&quot;Downloading: %s Bytes: %s&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="n">file_size</span><span class="p">)</span>

<span class="n">file_size_dl</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">block_sz</span> <span class="o">=</span> <span class="mi">8192</span>
<span class="k">while</span> <span class="n">True</span><span class="o">:</span>
    <span class="n">buffer</span> <span class="o">=</span> <span class="n">u</span><span class="p">.</span><span class="n">read</span><span class="p">(</span><span class="n">block_sz</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">not</span> <span class="n">buffer</span><span class="o">:</span>
        <span class="k">break</span>

    <span class="n">file_size_dl</span> <span class="o">+=</span> <span class="n">len</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
    <span class="n">f</span><span class="p">.</span><span class="n">write</span><span class="p">(</span><span class="n">buffer</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">r</span><span class="s">&quot;%10d  [%3.2f%%]&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">file_size_dl</span><span class="p">,</span> <span class="n">file_size_dl</span> <span class="o">*</span> <span class="mf">100.</span> <span class="o">/</span> <span class="n">file_size</span><span class="p">)</span>
    <span class="n">status</span> <span class="o">=</span> <span class="n">status</span> <span class="o">+</span> <span class="n">chr</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">len</span><span class="p">(</span><span class="n">status</span><span class="p">)</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">print</span> <span class="n">status</span><span class="p">,</span>

<span class="n">f</span><span class="p">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>


<p>使用第三方<a href="http://docs.python-requests.org/en/latest/index.html">requests</a>包</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">requests</span>
<span class="o">&gt;&gt;&gt;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">url</span> <span class="o">=</span> <span class="s">&quot;http://download.thinkbroadband.com/10MB.zip&quot;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">r</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print</span> <span class="n">len</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">content</span><span class="p">)</span>
<span class="mi">10485760</span>
</pre></div>


<h3>在virtualenv中如何使用不同的python版本</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1534210/use-different-python-version-with-virtualenv">链接</a></p>
<p>在创建virtualenv实例时，使用-p选项</p>
<div class="codehilite"><pre><span class="n">virtualenv</span> <span class="o">-</span><span class="n">p</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">python2</span><span class="mf">.6</span> <span class="o">&lt;</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">new</span><span class="o">/</span><span class="n">virtualenv</span><span class="o">/&gt;</span>
</pre></div>


<h3>python中如何将一行长代码切成多行</h3>
<p>问题 <a href="http://stackoverflow.com/questions/53162/how-can-i-do-a-line-break-line-continuation-in-python">链接</a></p>
<p>例如：</p>
<div class="codehilite"><pre><span class="n">e</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span> <span class="o">+</span> <span class="sc">&#39;b&#39;</span> <span class="o">+</span> <span class="sc">&#39;c&#39;</span> <span class="o">+</span> <span class="sc">&#39;d&#39;</span>
<span class="err">变成</span>
<span class="n">e</span> <span class="o">=</span> <span class="sc">&#39;a&#39;</span> <span class="o">+</span> <span class="sc">&#39;b&#39;</span> <span class="o">+</span>
    <span class="sc">&#39;c&#39;</span> <span class="o">+</span> <span class="sc">&#39;d&#39;</span>
</pre></div>


<p>括号中，可以直接换行</p>
<div class="codehilite"><pre><span class="n">a</span> <span class="o">=</span> <span class="n">dostuff</span><span class="p">(</span><span class="n">blahblah1</span><span class="p">,</span> <span class="n">blahblah2</span><span class="p">,</span> <span class="n">blahblah3</span><span class="p">,</span> <span class="n">blahblah4</span><span class="p">,</span> <span class="n">blahblah5</span><span class="p">,</span>
            <span class="n">blahblah6</span><span class="p">,</span> <span class="n">blahblah7</span><span class="p">)</span>
</pre></div>


<p>非括号你可以这么做</p>
<div class="codehilite"><pre><span class="n">a</span> <span class="o">=</span> <span class="sc">&#39;1&#39;</span> <span class="o">+</span> <span class="sc">&#39;2&#39;</span> <span class="o">+</span> <span class="sc">&#39;3&#39;</span> <span class="o">+</span> \
    <span class="sc">&#39;4&#39;</span> <span class="o">+</span> <span class="sc">&#39;5&#39;</span>
<span class="err">或者</span>
<span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="sc">&#39;1&#39;</span> <span class="o">+</span> <span class="sc">&#39;2&#39;</span> <span class="o">+</span> <span class="sc">&#39;3&#39;</span> <span class="o">+</span>
    <span class="sc">&#39;4&#39;</span> <span class="o">+</span> <span class="sc">&#39;5&#39;</span><span class="p">)</span>
</pre></div>


<p>可以查看下代码风格： <a href="http://www.python.org/dev/peps/pep-0008/">style guide</a>
推荐是后一种，但某些个别情况下，加入括号会导致错误</p>
<h3>如何找到一个目录下所有.txt文件</h3>
<p>问题 <a href="http://stackoverflow.com/questions/3964681/find-all-files-in-directory-with-extension-txt-with-python">链接</a></p>
<p>使用<a href="http://docs.python.org/2/library/glob.html">glob</a></p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">glob</span>
<span class="n">import</span> <span class="n">os</span>
<span class="n">os</span><span class="p">.</span><span class="n">chdir</span><span class="p">(</span><span class="s">&quot;/mydir&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">files</span> <span class="n">in</span> <span class="n">glob</span><span class="p">.</span><span class="n">glob</span><span class="p">(</span><span class="s">&quot;*.txt&quot;</span><span class="p">)</span><span class="o">:</span>
    <span class="n">print</span> <span class="n">files</span>
</pre></div>


<p>使用os.listdir</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">os</span>
<span class="n">os</span><span class="p">.</span><span class="n">chdir</span><span class="p">(</span><span class="s">&quot;/mydir&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">files</span> <span class="n">in</span> <span class="n">os</span><span class="p">.</span><span class="n">listdir</span><span class="p">(</span><span class="s">&quot;.&quot;</span><span class="p">)</span><span class="o">:</span>
    <span class="k">if</span> <span class="n">files</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&quot;.txt&quot;</span><span class="p">)</span><span class="o">:</span>
        <span class="n">print</span> <span class="n">files</span>
</pre></div>


<p>或者遍历目录</p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">os</span>
<span class="k">for</span> <span class="n">r</span><span class="p">,</span><span class="n">d</span><span class="p">,</span><span class="n">f</span> <span class="n">in</span> <span class="n">os</span><span class="p">.</span><span class="n">walk</span><span class="p">(</span><span class="s">&quot;/mydir&quot;</span><span class="p">)</span><span class="o">:</span>
    <span class="k">for</span> <span class="n">files</span> <span class="n">in</span> <span class="n">f</span><span class="o">:</span>
        <span class="k">if</span> <span class="n">files</span><span class="p">.</span><span class="n">endswith</span><span class="p">(</span><span class="s">&quot;.txt&quot;</span><span class="p">)</span><span class="o">:</span>
            <span class="n">print</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">join</span><span class="p">(</span><span class="n">r</span><span class="p">,</span><span class="n">files</span><span class="p">)</span>
</pre></div>


<h3>如何使用绝对路径import一个模块</h3>
<p>问题 <a href="http://stackoverflow.com/questions/67631/how-to-import-a-module-given-the-full-path">链接</a></p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">imp</span>

<span class="n">foo</span> <span class="o">=</span> <span class="n">imp</span><span class="p">.</span><span class="n">load_source</span><span class="p">(</span><span class="err">&#39;</span><span class="n">module</span><span class="p">.</span><span class="n">name</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">/</span><span class="n">path</span><span class="o">/</span><span class="n">to</span><span class="o">/</span><span class="n">file</span><span class="p">.</span><span class="n">py</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">foo</span><span class="p">.</span><span class="n">MyClass</span><span class="p">()</span>
</pre></div>


<h3>如何在遍历一个list时删除某些玄素</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1207406/remove-items-from-a-list-while-iterating-in-python">链接</a></p>
<p>使用列表解析</p>
<div class="codehilite"><pre><span class="n">somelist</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="n">in</span> <span class="n">somelist</span> <span class="k">if</span> <span class="n">determine</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</pre></div>


<p>上面那个操作将产生一个全新的somelist对象，而失去了对原有somelist对象的引用</p>
<div class="codehilite"><pre><span class="cp">#在原有对象上进行修改</span>
<span class="n">somelist</span><span class="p">[</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="n">in</span> <span class="n">somelist</span> <span class="k">if</span> <span class="n">determine</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</pre></div>


<p>使用itertools</p>
<div class="codehilite"><pre><span class="n">from</span> <span class="n">itertools</span> <span class="n">import</span> <span class="n">ifilterfalse</span>
<span class="n">somelist</span><span class="p">[</span><span class="o">:</span><span class="p">]</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="n">ifilterfalse</span><span class="p">(</span><span class="n">determine</span><span class="p">,</span> <span class="n">somelist</span><span class="p">))</span>
</pre></div>


<h3>如何强制使用浮点数除法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1267869/how-can-i-force-division-to-be-floating-point-in-python">链接</a></p>
<p>如何强制使除法结果c是浮点数</p>
<div class="codehilite"><pre><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
</pre></div>


<p>可以使用__future__</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">from</span> <span class="n">__future__</span> <span class="n">import</span> <span class="n">division</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">4</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">b</span> <span class="o">=</span> <span class="mi">6</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">c</span>
<span class="mf">0.66666666666666663</span>
</pre></div>


<p>或者转换,如果除数或被除数是浮点数，那么结果也是浮点数</p>
<div class="codehilite"><pre><span class="n">c</span> <span class="o">=</span> <span class="n">a</span> <span class="o">/</span> <span class="kt">float</span><span class="p">(</span><span class="n">b</span><span class="p">)</span>
</pre></div>


<h3>如何映射两个列表成为一个字典</h3>
<p>问题 <a href="http://stackoverflow.com/questions/209840/map-two-lists-into-a-dictionary-in-python">链接</a></p>
<p>两个列表</p>
<div class="codehilite"><pre><span class="n">keys</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">name</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">age</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">food</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="p">(</span><span class="err">&#39;</span><span class="n">Monty</span><span class="err">&#39;</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">spam</span><span class="err">&#39;</span><span class="p">)</span>
</pre></div>


<p>如何得到</p>
<div class="codehilite"><pre><span class="n">dict</span> <span class="o">=</span> <span class="p">{</span><span class="err">&#39;</span><span class="n">name</span><span class="err">&#39;</span> <span class="o">:</span> <span class="err">&#39;</span><span class="n">Monty</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">age</span><span class="err">&#39;</span> <span class="o">:</span> <span class="mi">42</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">food</span><span class="err">&#39;</span> <span class="o">:</span> <span class="err">&#39;</span><span class="n">spam</span><span class="err">&#39;</span><span class="p">}</span>
</pre></div>


<p>使用zip</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">keys</span> <span class="o">=</span> <span class="p">[</span><span class="sc">&#39;a&#39;</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="p">,</span> <span class="sc">&#39;c&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dictionary</span> <span class="o">=</span> <span class="n">dict</span><span class="p">(</span><span class="n">zip</span><span class="p">(</span><span class="n">keys</span><span class="p">,</span> <span class="n">values</span><span class="p">))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print</span> <span class="n">dictionary</span>
<span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span> <span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">3</span><span class="p">}</span>
</pre></div>


<h3>找到当前目录及文件所在目录</h3>
<p>问题 <a href="http://stackoverflow.com/questions/5137497/find-current-directory-and-files-directory">链接</a></p>
<p>查找当前目录使用os.getcwd()</p>
<p>查找某个文件的目录，使用, <a href="http://docs.python.org/2/library/os.path.html">os.path</a></p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span>
<span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">__file__</span><span class="p">)</span>
</pre></div>


<h3>为何1 in [1,0] == True执行结果是False</h3>
<p>问题 <a href="http://stackoverflow.com/questions/9284350/why-does-1-in-1-0-true-evaluate-to-false">链接</a></p>
<p>有如下</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="mi">1</span> <span class="k">in</span> <span class="err">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="cp">]</span>             # This is expected
True
&gt;&gt;&gt; 1 in <span class="cp">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="cp">]</span> == True     # This is strange
False
&gt;&gt;&gt; (1 in <span class="cp">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="cp">]</span>) == True   # This is what I wanted it to be
True
&gt;&gt;&gt; 1 in (<span class="cp">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="cp">]</span> == True)   # But it&#39;s not just a precedence issue!
                           # It did not raise an exception on the second example.

Traceback (most recent call last):
  File &quot;<span class="nt">&lt;pyshell</span><span class="err">#</span><span class="na">4</span><span class="nt">&gt;</span>&quot;, line 1, in <span class="nt">&lt;module&gt;</span>
      1 in (<span class="cp">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="cp">]</span> == True)
      TypeError: argument of type &#39;bool&#39; is not iterable
</pre></div>


<p>这里python使用了比较运算符链</p>
<div class="codehilite"><pre><span class="mi">1</span> <span class="n">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">True</span>
</pre></div>


<p>将被转为</p>
<div class="codehilite"><pre><span class="p">(</span><span class="mi">1</span> <span class="n">in</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span> <span class="n">and</span> <span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">True</span><span class="p">)</span>
</pre></div>


<p>很显然是false的</p>
<p>同样的</p>
<div class="codehilite"><pre><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span> <span class="o">&lt;</span> <span class="n">c</span>
</pre></div>


<p>会被转为</p>
<div class="codehilite"><pre><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">b</span><span class="p">)</span> <span class="n">and</span> <span class="p">(</span><span class="n">b</span> <span class="o">&lt;</span> <span class="n">c</span><span class="p">)</span> <span class="err">#</span> <span class="n">b</span><span class="err">不会被解析两次</span>
</pre></div>


<p><a href="http://docs.python.org/2/reference/expressions.html#not-in">具体文档</a></p>
<h3>Python中的switch替代语法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/60208/replacements-for-switch-statement-in-python">链接</a></p>
<p>python中没有switch，有什么推荐的处理方法么</p>
<p>使用字典:</p>
<div class="codehilite"><pre><span class="n">def</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">:</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span>
        <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="p">}.</span><span class="n">get</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="mi">9</span><span class="p">)</span>
</pre></div>


<p>Python Cookbook中的几种方式</p>
<p><a href="http://code.activestate.com/recipes/410692/">Readable switch construction without lambdas or dictionaries</a></p>
<p><a href="http://code.activestate.com/recipes/410695/">Exception-based Switch-Case</a></p>
<p><a href="http://code.activestate.com/recipes/181064/">Using a Dictionary in place of a 'switch' statement</a></p>
<h3>如何将字符串转换为datetime</h3>
<p>问题 <a href="http://stackoverflow.com/questions/466345/converting-string-into-datetime">链接</a></p>
<p>可以查看下time模块的<a href="http://docs.python.org/2/library/time.html#time.strptime">strptime</a>方法，反向操作是<a href="http://docs.python.org/2/library/time.html#time.strftime">strftime</a></p>
<div class="codehilite"><pre><span class="n">from</span> <span class="n">datetime</span> <span class="n">import</span> <span class="n">datetime</span>
<span class="n">date_object</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">strptime</span><span class="p">(</span><span class="err">&#39;</span><span class="n">Jun</span> <span class="mi">1</span> <span class="mi">2005</span>  <span class="mi">1</span><span class="o">:</span><span class="mi">33</span><span class="n">PM</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="o">%</span><span class="n">b</span> <span class="o">%</span><span class="n">d</span> <span class="o">%</span><span class="n">Y</span> <span class="o">%</span><span class="n">I</span><span class="o">:%</span><span class="n">M</span><span class="o">%</span><span class="n">p</span><span class="err">&#39;</span><span class="p">)</span>
</pre></div>


<p><a href="http://docs.python.org/2/library/datetime.html#strftime-and-strptime-behavior">扩展文档</a></p>
<h3>Python中有没有简单优雅的方式定义单例类</h3>
<p>问题 <a href="http://stackoverflow.com/questions/31875/is-there-a-simple-elegant-way-to-define-singletons-in-python">链接</a></p>
<p>我不认为有必要，一个拥有函数的模块（不是类）可以作为很好的单例使用，它的所有变量被绑定到这个模块，无论如何都不能被重复实例化</p>
<p>如果你确实想用一个类来实现，在python中不能创建私有类或私有构造函数,所以你不能隔离多个实例而仅仅通过自己的API来访问属性</p>
<p>我还是认为将函数放入模块，并将其作为一个单例来使用是最好的办法</p>
<h3>将一个字符串转为一个字典</h3>
<p>问题 <a href="http://stackoverflow.com/questions/988228/converting-a-string-to-dictionary">链接</a></p>
<p>如何将字符串转成字典，不适用eval</p>
<div class="codehilite"><pre><span class="n">s</span> <span class="o">=</span> <span class="s">&quot;{&#39;muffin&#39; : &#39;lolz&#39;, &#39;foo&#39; : &#39;kitty&#39;}&quot;</span>
</pre></div>


<p>从python2.6开始，你可以使用内建模块 ast.literal_eval</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">ast</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">ast</span><span class="p">.</span><span class="n">literal_eval</span><span class="p">(</span><span class="s">&quot;{&#39;muffin&#39; : &#39;lolz&#39;, &#39;foo&#39; : &#39;kitty&#39;}&quot;</span><span class="p">)</span>
<span class="p">{</span><span class="err">&#39;</span><span class="n">muffin</span><span class="err">&#39;</span><span class="o">:</span> <span class="err">&#39;</span><span class="n">lolz</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">foo</span><span class="err">&#39;</span><span class="o">:</span> <span class="err">&#39;</span><span class="n">kitty</span><span class="err">&#39;</span><span class="p">}</span>
</pre></div>


<p>这个做法比直接eval更安全
帮助文档</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="nx">help</span><span class="p">(</span><span class="nx">ast</span><span class="p">.</span><span class="nx">literal_eval</span><span class="p">)</span>
<span class="nx">Help</span> <span class="nx">on</span> <span class="kd">function</span> <span class="nx">literal_eval</span> <span class="k">in</span> <span class="nx">module</span> <span class="nx">ast</span><span class="o">:</span>

<span class="nx">literal_eval</span><span class="p">(</span><span class="nx">node_or_string</span><span class="p">)</span>
    <span class="nx">Safely</span> <span class="nx">evaluate</span> <span class="nx">an</span> <span class="nx">expression</span> <span class="nx">node</span> <span class="nx">or</span> <span class="nx">a</span> <span class="nx">string</span> <span class="nx">containing</span> <span class="nx">a</span> <span class="nx">Python</span>
    <span class="nx">expression</span><span class="p">.</span>  <span class="nx">The</span> <span class="nx">string</span> <span class="nx">or</span> <span class="nx">node</span> <span class="nx">provided</span> <span class="nx">may</span> <span class="nx">only</span> <span class="nx">consist</span> <span class="nx">of</span> <span class="nx">the</span> <span class="nx">following</span>
    <span class="nx">Python</span> <span class="nx">literal</span> <span class="nx">structures</span><span class="o">:</span> <span class="nx">strings</span><span class="p">,</span> <span class="nx">numbers</span><span class="p">,</span> <span class="nx">tuples</span><span class="p">,</span> <span class="nx">lists</span><span class="p">,</span> <span class="nx">dicts</span><span class="p">,</span> <span class="nx">booleans</span><span class="p">,</span>
    <span class="nx">and</span> <span class="nx">None</span><span class="p">.</span>
</pre></div>


<p>举例</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="nb">eval</span><span class="p">(</span><span class="s2">&quot;shutil.rmtree(&#39;mongo&#39;)&quot;</span><span class="p">)</span>
<span class="nx">Traceback</span> <span class="p">(</span><span class="nx">most</span> <span class="nx">recent</span> <span class="nb">call</span> <span class="nb">last</span><span class="p">):</span>
<span class="nb">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="nb">line</span> <span class="mi">1</span><span class="p">,</span> <span class="k">in</span> <span class="o">&lt;</span><span class="nx">module</span><span class="o">&gt;</span>
<span class="nb">File</span> <span class="s2">&quot;&lt;string&gt;&quot;</span><span class="p">,</span> <span class="nb">line</span> <span class="mi">1</span><span class="p">,</span> <span class="k">in</span> <span class="o">&lt;</span><span class="nx">module</span><span class="o">&gt;</span>
<span class="nb">File</span> <span class="s2">&quot;/opt/Python-2.6.1/lib/python2.6/shutil.py&quot;</span><span class="p">,</span> <span class="nb">line</span> <span class="mi">208</span><span class="p">,</span> <span class="k">in</span> <span class="nx">rmtree</span>
    <span class="nx">onerror</span><span class="p">(</span><span class="nx">os.listdir</span><span class="p">,</span> <span class="nb">path</span><span class="p">,</span> <span class="nx">sys.exc_info</span><span class="p">())</span>
<span class="nb">File</span> <span class="s2">&quot;/opt/Python-2.6.1/lib/python2.6/shutil.py&quot;</span><span class="p">,</span> <span class="nb">line</span> <span class="mi">206</span><span class="p">,</span> <span class="k">in</span> <span class="nx">rmtree</span>
    <span class="n">names</span> <span class="o">=</span> <span class="nx">os.listdir</span><span class="p">(</span><span class="nb">path</span><span class="p">)</span>
<span class="nx">OSError</span><span class="p">:</span> <span class="err">[</span><span class="nx">Errno</span> <span class="mi">2</span><span class="cp">]</span> No such file or directory: &#39;mongo&#39;
&gt;&gt;&gt; ast.literal_eval(&quot;shutil.rmtree(&#39;mongo&#39;)&quot;)
Traceback (most recent call last):
File &quot;<span class="nt">&lt;stdin&gt;</span>&quot;, line 1, in <span class="nt">&lt;module&gt;</span>
File &quot;/opt/Python-2.6.1/lib/python2.6/ast.py&quot;, line 68, in literal_eval
    return _convert(node_or_string)
File &quot;/opt/Python-2.6.1/lib/python2.6/ast.py&quot;, line 67, in _convert
    raise ValueError(&#39;malformed string&#39;)
ValueError: malformed string
</pre></div>


<h3>Python如何检查一个对象是list或者tuple，但是不是一个字符串</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1835018/python-check-if-an-object-is-a-list-or-tuple-but-not-string">链接</a></p>
<p>原来的做法是</p>
<div class="codehilite"><pre><span class="n">assert</span> <span class="n">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="p">(</span><span class="n">list</span><span class="p">,</span> <span class="n">tuple</span><span class="p">))</span>
</pre></div>


<p>有没有更好的做法</p>
<p>我认为下面的方式是你需要的</p>
<div class="codehilite"><pre><span class="n">assert</span> <span class="n">not</span> <span class="n">isinstance</span><span class="p">(</span><span class="n">lst</span><span class="p">,</span> <span class="n">basestring</span><span class="p">)</span>
</pre></div>


<p>原来的方式，你可能会漏过很多像列表，但并非list/tuple的</p>
<h3>使用 'if x is not None' 还是'if not x is None'</h3>
<p>问题 <a href="http://stackoverflow.com/questions/2710940/python-if-x-is-not-none-or-if-not-x-is-none">链接</a></p>
<p>我总想着使用 'if x is not None' 会更加简明</p>
<p>但是google的Python风格指南使用的却是 'if x is not None'</p>
<p>性能上没有什么区别，他们编译成相同的字节码</p>
<div class="codehilite"><pre><span class="n">Python</span> <span class="mf">2.6.2</span> <span class="p">(</span><span class="n">r262</span><span class="o">:</span><span class="mi">71600</span><span class="p">,</span> <span class="n">Apr</span> <span class="mi">15</span> <span class="mi">2009</span><span class="p">,</span> <span class="mo">07</span><span class="o">:</span><span class="mi">20</span><span class="o">:</span><span class="mi">39</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">dis</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">def</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>    <span class="k">return</span> <span class="n">x</span> <span class="n">is</span> <span class="n">not</span> <span class="n">None</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dis</span><span class="p">.</span><span class="n">dis</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="mi">2</span>           <span class="mi">0</span> <span class="n">LOAD_FAST</span>                <span class="mi">0</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="mi">3</span> <span class="n">LOAD_CONST</span>               <span class="mi">0</span> <span class="p">(</span><span class="n">None</span><span class="p">)</span>
            <span class="mi">6</span> <span class="n">COMPARE_OP</span>               <span class="mi">9</span> <span class="p">(</span><span class="n">is</span> <span class="n">not</span><span class="p">)</span>
            <span class="mi">9</span> <span class="n">RETURN_VALUE</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">def</span> <span class="n">g</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>   <span class="k">return</span> <span class="n">not</span> <span class="n">x</span> <span class="n">is</span> <span class="n">None</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dis</span><span class="p">.</span><span class="n">dis</span><span class="p">(</span><span class="n">g</span><span class="p">)</span>
<span class="mi">2</span>           <span class="mi">0</span> <span class="n">LOAD_FAST</span>                <span class="mi">0</span> <span class="p">(</span><span class="n">x</span><span class="p">)</span>
            <span class="mi">3</span> <span class="n">LOAD_CONST</span>               <span class="mi">0</span> <span class="p">(</span><span class="n">None</span><span class="p">)</span>
            <span class="mi">6</span> <span class="n">COMPARE_OP</span>               <span class="mi">9</span> <span class="p">(</span><span class="n">is</span> <span class="n">not</span><span class="p">)</span>
            <span class="mi">9</span> <span class="n">RETURN_VALUE</span>
</pre></div>


<p>在风格上，我尽量避免 'not x is y' 这种形式，虽然编译器会认为和 'not (x is y)'一样，但是读代码的人或许会误解为 '(not x) is y'</p>
<p>如果写作 'x is not y' 就不会有歧义</p>
<p>最佳实践</p>
<div class="codehilite"><pre><span class="k">if</span> <span class="n">x</span> <span class="n">is</span> <span class="n">not</span> <span class="n">None</span><span class="o">:</span>
    <span class="err">#</span> <span class="n">Do</span> <span class="n">something</span> <span class="n">about</span> <span class="n">x</span>
</pre></div>


<h3>如何获取一个文件的创建和修改时间</h3>
<p>问题 <a href="http://stackoverflow.com/questions/237079/how-to-get-file-creation-modification-date-times-in-python">链接</a></p>
<p>跨平台的获取文件创建及修改时间的方法</p>
<p>你有很多选择</p>
<p>使用<a href="http://docs.python.org/release/2.5.2/lib/module-os.path.html#l2h-2177">os.path.getmtime</a>或者<a href="http://docs.python.org/release/2.5.2/lib/module-os.path.html#l2h-2178">os.path.getctime</a></p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">,</span> <span class="n">time</span>
<span class="n">print</span> <span class="s">&quot;last modified: %s&quot;</span> <span class="o">%</span> <span class="n">time</span><span class="p">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">getmtime</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
<span class="n">print</span> <span class="s">&quot;created: %s&quot;</span> <span class="o">%</span> <span class="n">time</span><span class="p">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">os</span><span class="p">.</span><span class="n">path</span><span class="p">.</span><span class="n">getctime</span><span class="p">(</span><span class="n">file</span><span class="p">))</span>
</pre></div>


<p>或者<a href="http://www.python.org/doc/2.5.2/lib/module-stat.html">os.stat</a></p>
<div class="codehilite"><pre><span class="n">import</span> <span class="n">os</span><span class="p">,</span> <span class="n">time</span>
<span class="p">(</span><span class="n">mode</span><span class="p">,</span> <span class="n">ino</span><span class="p">,</span> <span class="n">dev</span><span class="p">,</span> <span class="n">nlink</span><span class="p">,</span> <span class="n">uid</span><span class="p">,</span> <span class="n">gid</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">atime</span><span class="p">,</span> <span class="n">mtime</span><span class="p">,</span> <span class="n">ctime</span><span class="p">)</span> <span class="o">=</span> <span class="n">os</span><span class="p">.</span><span class="n">stat</span><span class="p">(</span><span class="n">file</span><span class="p">)</span>
<span class="n">print</span> <span class="s">&quot;last modified: %s&quot;</span> <span class="o">%</span> <span class="n">time</span><span class="p">.</span><span class="n">ctime</span><span class="p">(</span><span class="n">mtime</span><span class="p">)</span>
</pre></div>


<p>注意，ctime()并非指*nix系统中文件创建时间，而是这个节点数据的最后修改时间</p>
<h3>如何离开virtualenv</h3>
<p>问题 <a href="http://stackoverflow.com/questions/990754/how-to-leave-a-python-virtualenv">链接</a></p>
<p>使用virtualenv时</p>
<div class="codehilite"><pre><span class="n">me</span><span class="err">@</span><span class="n">mymachine</span><span class="o">:~</span><span class="err">$</span> <span class="n">workon</span> <span class="n">env1</span>
<span class="p">(</span><span class="n">env1</span><span class="p">)</span><span class="n">me</span><span class="err">@</span><span class="n">mymachine</span><span class="o">:~</span><span class="err">$</span> <span class="n">workon</span> <span class="n">env2</span>
<span class="p">(</span><span class="n">env2</span><span class="p">)</span><span class="n">me</span><span class="err">@</span><span class="n">mymachine</span><span class="o">:~</span><span class="err">$</span> <span class="n">workon</span> <span class="n">env1</span>
<span class="p">(</span><span class="n">env1</span><span class="p">)</span><span class="n">me</span><span class="err">@</span><span class="n">mymachine</span><span class="o">:~</span><span class="err">$</span>
</pre></div>


<p>如何退出某个环境</p>
<div class="codehilite"><pre><span class="err">$</span> <span class="n">deactivate</span>
</pre></div>


<h3>如何认为地抛出一个异常</h3>
<p>问题 <a href="http://stackoverflow.com/questions/2052390/how-do-i-manually-throw-raise-an-exception-in-python">链接</a></p>
<p>pythonic</p>
<div class="codehilite"><pre><span class="n">raise</span> <span class="n">Exception</span><span class="p">(</span><span class="s">&quot;I know python!&quot;</span><span class="p">)</span>
</pre></div>


<p>更多可参考 <a href="http://docs.python.org/2/reference/simple_stmts.html#the-raise-statement">文档</a></p>
<h3>在Python中如何展示二进制字面值</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1476/how-do-you-express-binary-literals-in-python">链接</a></p>
<p>十六进制可以</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="mh">0x12AF</span>
<span class="mi">4783</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mh">0x100</span>
<span class="mi">256</span>
</pre></div>


<p>八进制可以</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="mo">01267</span>
<span class="mi">695</span>
<span class="o">&gt;&gt;&gt;</span> <span class="mo">0100</span>
<span class="mi">64</span>
</pre></div>


<p>二进制如何表示？</p>
<p>Python 2.5 及更早版本: 可以表示为 int('01010101111',2)  但没有字面量</p>
<p>Python 2.6 beta: 可以使用0b1100111 or 0B1100111 表示</p>
<p>Python 2.6 beta: 也可以使用 0o27 or 0O27 (第二字字符是字母 O)</p>
<p>Python 3.0 beta: 同2.6，但不支持027这种语法</p>
<h3>Python中检查类型的权威方法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/152580/whats-the-canonical-way-to-check-for-type-in-python">链接</a></p>
<p>检查一个对象是否是给定类型或者对象是否继承于给定类型？</p>
<p>比如给定一个对象o,如何判断是不是一个str</p>
<p>检查是否是str</p>
<div class="codehilite"><pre><span class="n">type</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="n">is</span> <span class="n">str</span>
</pre></div>


<p>检查是否是str或者str的子类</p>
<div class="codehilite"><pre><span class="n">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">str</span><span class="p">)</span>
</pre></div>


<p>下面的方法在某些情况下有用</p>
<div class="codehilite"><pre><span class="n">issubclass</span><span class="p">(</span><span class="n">type</span><span class="p">(</span><span class="n">o</span><span class="p">),</span> <span class="n">str</span><span class="p">)</span>
<span class="n">type</span><span class="p">(</span><span class="n">o</span><span class="p">)</span> <span class="n">in</span> <span class="p">([</span><span class="n">str</span><span class="p">]</span> <span class="o">+</span> <span class="n">str</span><span class="p">.</span><span class="n">__subclasses__</span><span class="p">())</span>
</pre></div>


<p>注意，你或许想要的是</p>
<div class="codehilite"><pre><span class="n">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="n">basestring</span><span class="p">)</span>
</pre></div>


<p>因为unicode字符串可以满足判定(unicode 不是str的子类，但是str和unicode都是basestring的子类)</p>
<p>可选的，isinstance可以接收多个类型参数，只要满足其中一个即True</p>
<div class="codehilite"><pre><span class="n">isinstance</span><span class="p">(</span><span class="n">o</span><span class="p">,</span> <span class="p">(</span><span class="n">str</span><span class="p">,</span> <span class="n">unicode</span><span class="p">))</span>
</pre></div>


<h3>如何获取Python的site-packages目录位置</h3>
<p>问题 <a href="http://stackoverflow.com/questions/122327/how-do-i-find-the-location-of-my-python-site-packages-directory">链接</a></p>
<p>参考 <a href="http://docs.djangoproject.com/en/dev/topics/install/#remove-any-old-versions-of-django">How to Install Django" documentation</a></p>
<p>可以在shell中执行</p>
<div class="codehilite"><pre><span class="n">python</span> <span class="o">-</span><span class="n">c</span> <span class="s">&quot;from distutils.sysconfig import get_python_lib; print(get_python_lib())&quot;</span>
</pre></div>


<p>更好的可读性</p>
<div class="codehilite"><pre><span class="n">from</span> <span class="n">distutils</span><span class="p">.</span><span class="n">sysconfig</span> <span class="n">import</span> <span class="n">get_python_lib</span>
<span class="n">print</span><span class="p">(</span><span class="n">get_python_lib</span><span class="p">())</span>
</pre></div>


<h3>Python中*<em>和</em>的作用</h3>
<p>问题  <a href="http://stackoverflow.com/questions/36901/what-does-double-star-and-star-do-for-python-parameters">链接</a></p>
<p><em>args和</em>*kwargs允许函数拥有任意数量的参数，具体可以查看 <a href="http://docs.python.org/dev/tutorial/controlflow.html#more-on-defining-functions">more on defining functions</a></p>
<p>*args将函数所有参数转为序列</p>
<div class="codehilite"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">:</span> <span class="n">def</span> <span class="n">foo</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span><span class="o">:</span>     <span class="k">for</span> <span class="n">a</span> <span class="n">in</span> <span class="n">args</span><span class="o">:</span>
<span class="p">...</span><span class="o">:</span>         <span class="n">print</span> <span class="n">a</span>
<span class="p">...</span><span class="o">:</span>
<span class="p">...</span><span class="o">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">:</span> <span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="mi">1</span>


<span class="n">In</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">:</span> <span class="n">foo</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="mi">1</span>
<span class="mi">2</span>
<span class="mi">3</span>
</pre></div>


<p>**kwargs 将函数所有关键字参数转为一个字典</p>
<div class="codehilite"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">:</span> <span class="n">def</span> <span class="n">bar</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span><span class="o">:</span>     <span class="k">for</span> <span class="n">a</span> <span class="n">in</span> <span class="n">kwargs</span><span class="o">:</span>
<span class="p">...</span><span class="o">:</span>         <span class="n">print</span> <span class="n">a</span><span class="p">,</span> <span class="n">kwargs</span><span class="p">[</span><span class="n">a</span><span class="p">]</span>
<span class="p">...</span><span class="o">:</span>
<span class="p">...</span><span class="o">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">:</span> <span class="n">bar</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s">&quot;one&quot;</span><span class="p">,</span> <span class="n">age</span><span class="o">=</span><span class="mi">27</span><span class="p">)</span>
<span class="n">age</span> <span class="mi">27</span>
<span class="n">name</span> <span class="n">one</span>
</pre></div>


<p>两种用法可以组合使用</p>
<div class="codehilite"><pre><span class="n">def</span> <span class="n">foo</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span><span class="o">:</span>
    <span class="n">pass</span>
</pre></div>


<p>*l的另一个用法是用于函数调用时的参数列表解包(unpack)</p>
<div class="codehilite"><pre><span class="n">In</span> <span class="p">[</span><span class="mi">9</span><span class="p">]</span><span class="o">:</span> <span class="n">def</span> <span class="n">foo</span><span class="p">(</span><span class="n">bar</span><span class="p">,</span> <span class="n">lee</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span><span class="o">:</span>     <span class="n">print</span> <span class="n">bar</span><span class="p">,</span> <span class="n">lee</span>
<span class="p">...</span><span class="o">:</span>
<span class="p">...</span><span class="o">:</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">10</span><span class="p">]</span><span class="o">:</span> <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span>

<span class="n">In</span> <span class="p">[</span><span class="mi">11</span><span class="p">]</span><span class="o">:</span> <span class="n">foo</span><span class="p">(</span><span class="o">*</span><span class="n">l</span><span class="p">)</span>
<span class="mi">1</span> <span class="mi">2</span>
</pre></div>


<p>在Python3.0中，可以将*l放在等号左边用于赋值  <a href="http://www.python.org/dev/peps/pep-3132/">Extended Iterable Unpacking</a></p>
<div class="codehilite"><pre><span class="n">first</span><span class="p">,</span> <span class="o">*</span><span class="n">rest</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
<span class="n">first</span><span class="p">,</span> <span class="o">*</span><span class="n">l</span><span class="p">,</span> <span class="n">last</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">]</span>
</pre></div>


<h3>字符串格式化 % vs format</h3>
<p>问题 <a href="http://stackoverflow.com/questions/5082452/python-string-formatting-vs-format">链接</a></p>
<p>Python2.6中引入string.format()方法，语法和原先%操作符的字符串格式化差异较大</p>
<p>在什么情况下使用哪种更好?</p>
<p>以下的输出是一致的，有什么区别</p>
<div class="codehilite"><pre><span class="c">#!/usr/bin/python</span>
<span class="n">sub1</span> <span class="o">=</span> <span class="s">&quot;python string!&quot;</span>
<span class="n">sub2</span> <span class="o">=</span> <span class="s">&quot;an arg&quot;</span>

<span class="n">a</span> <span class="o">=</span> <span class="s">&quot;i am a </span><span class="si">%s</span><span class="s">&quot;</span><span class="o">%</span><span class="n">sub1</span>
<span class="n">b</span> <span class="o">=</span> <span class="s">&quot;i am a {0}&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sub1</span><span class="p">)</span>

<span class="n">c</span> <span class="o">=</span> <span class="s">&quot;with </span><span class="si">%(kwarg)s</span><span class="s">!&quot;</span><span class="o">%</span><span class="p">{</span><span class="s">&#39;kwarg&#39;</span><span class="p">:</span><span class="n">sub2</span><span class="p">}</span>
<span class="n">d</span> <span class="o">=</span> <span class="s">&quot;with {kwarg}!&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">kwarg</span><span class="o">=</span><span class="n">sub2</span><span class="p">)</span>

<span class="k">print</span> <span class="n">a</span>
<span class="k">print</span> <span class="n">b</span>
<span class="k">print</span> <span class="n">c</span>
<span class="k">print</span> <span class="n">d</span>
</pre></div>


<p>.format 看起来更加强大，可以用在很多情况.</p>
<p>例如你可以在格式化时重用传入的参数,而你用%时无法做到这点</p>
<p>另一个比较讨厌的是，%只处理 一个变量或一个元组, 你或许会认为下面的语法是正确的</p>
<div class="codehilite"><pre><span class="s">&quot;hi there %s&quot;</span> <span class="o">%</span> <span class="n">name</span>
</pre></div>


<p>但当name恰好是(1,2,3)时，会抛出TypeError异常.为了保证总是正确的，你必须这么写</p>
<div class="codehilite"><pre><span class="s">&quot;hi there %s&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">name</span><span class="p">,)</span>   <span class="err">#</span> <span class="n">supply</span> <span class="n">the</span> <span class="n">single</span> <span class="n">argument</span> <span class="n">as</span> <span class="n">a</span> <span class="n">single</span><span class="o">-</span><span class="n">item</span> <span class="n">tuple</span>
</pre></div>


<p>这么写很丑陋， .format没有这些问题</p>
<p>什么时候不考虑使用.format</p>
<div class="codehilite"><pre><span class="err">你对</span><span class="p">.</span><span class="n">format</span><span class="err">知之甚少</span>
<span class="err">使用</span><span class="n">Python2</span><span class="mf">.5</span>
</pre></div>


<h3>Python中什么项目结构更好</h3>
<p>问题 <a href="http://stackoverflow.com/questions/193161/what-is-the-best-project-structure-for-a-python-application">链接</a></p>
<p>假设你要开发一个较大的客户端程序(非web端),如何组织项目目录和递归？</p>
<p>不要太在意这个.按你高兴的方式组织就行.Python项目很简单，所以没有那么多愚蠢的规则</p>
<div class="codehilite"><pre><span class="o">/</span><span class="n">scripts</span> <span class="n">or</span> <span class="o">/</span><span class="n">bin</span>  <span class="err">命令行脚本</span>
<span class="o">/</span><span class="n">tests</span> <span class="err">测试</span>
<span class="o">/</span><span class="n">lib</span> <span class="n">C</span><span class="o">-</span><span class="err">语言包</span>
<span class="o">/</span><span class="n">doc</span> <span class="err">文档</span>
<span class="o">/</span><span class="n">apidoc</span> <span class="n">api</span><span class="err">文档</span>
</pre></div>


<p>并且顶层目录包含README和Config</p>
<p>难以抉择的是，是否使用/src树. /src,/lib,/bin在Python中没有明显的区别，和Java/c不同</p>
<p>因为顶层/src文件夹显得没有什么实际意义，你的顶层目录可以是程序顶层架构的目录</p>
<div class="codehilite"><pre><span class="o">/</span><span class="n">foo</span>
<span class="o">/</span><span class="n">bar</span>
<span class="o">/</span><span class="n">baz</span>
</pre></div>


<p>我建议将这些文件放入到"模块名"的目录中，这样，如果你在写一个应用叫做quux, /quux目录将包含所有这些东西</p>
<p>你可以在PYTHONPATH中加入 /path/to/quux/foo,这样你可以QUUX.foo中重用模块</p>
<p>另一个回答</p>
<div class="codehilite"><pre><span class="n">Project</span><span class="o">/</span>
<span class="o">|--</span> <span class="n">bin</span><span class="o">/</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="n">project</span>
<span class="o">|</span>
<span class="o">|--</span> <span class="n">project</span><span class="o">/</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="n">test</span><span class="o">/</span>
<span class="o">|</span>   <span class="o">|</span>   <span class="o">|--</span> <span class="n">__init__</span><span class="p">.</span><span class="n">py</span>
<span class="o">|</span>   <span class="o">|</span>   <span class="o">|--</span> <span class="n">test_main</span><span class="p">.</span><span class="n">py</span>
<span class="o">|</span>   <span class="o">|</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="n">__init__</span><span class="p">.</span><span class="n">py</span>
<span class="o">|</span>   <span class="o">|--</span> <span class="n">main</span><span class="p">.</span><span class="n">py</span>
<span class="o">|</span>
<span class="o">|--</span> <span class="n">setup</span><span class="p">.</span><span class="n">py</span>
<span class="o">|--</span> <span class="n">README</span>
</pre></div>


<h3>argparse可选位置参数</h3>
<p>问题 <a href="http://stackoverflow.com/questions/4480075/argparse-optional-positional-arguments">链接</a></p>
<p>脚本运行 usage: installer.py dir [-h] [-v]</p>
<p>dir是一个位置参数，定义如下</p>
<div class="codehilite"><pre><span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="err">&#39;</span><span class="n">dir</span><span class="err">&#39;</span><span class="p">,</span> <span class="k">default</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="n">getcwd</span><span class="p">())</span>
</pre></div>


<p>我想让dir变为可选，如果未设置，使用os.getcwd()</p>
<p>不幸的是，当我不指定dir时，得到错误 "Error: Too few arguments"</p>
<p>尝试使用 nargs='?'</p>
<div class="codehilite"><pre><span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="err">&#39;</span><span class="n">dir</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="sc">&#39;?&#39;</span><span class="p">,</span> <span class="k">default</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="n">getcwd</span><span class="p">())</span>
</pre></div>


<p>例子</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">os</span><span class="p">,</span> <span class="n">argparse</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="p">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="err">&#39;</span><span class="o">-</span><span class="n">v</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="err">&#39;</span><span class="n">store_true</span><span class="err">&#39;</span><span class="p">)</span>
<span class="n">_StoreTrueAction</span><span class="p">(</span><span class="n">option_strings</span><span class="o">=</span><span class="p">[</span><span class="err">&#39;</span><span class="o">-</span><span class="n">v</span><span class="err">&#39;</span><span class="p">],</span> <span class="n">dest</span><span class="o">=</span><span class="sc">&#39;v&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="k">const</span><span class="o">=</span><span class="n">True</span><span class="p">,</span> <span class="k">default</span><span class="o">=</span><span class="n">False</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="n">None</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">None</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="n">None</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="p">.</span><span class="n">add_argument</span><span class="p">(</span><span class="err">&#39;</span><span class="n">dir</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="sc">&#39;?&#39;</span><span class="p">,</span> <span class="k">default</span><span class="o">=</span><span class="n">os</span><span class="p">.</span><span class="n">getcwd</span><span class="p">())</span>
<span class="n">_StoreAction</span><span class="p">(</span><span class="n">option_strings</span><span class="o">=</span><span class="p">[],</span> <span class="n">dest</span><span class="o">=</span><span class="err">&#39;</span><span class="n">dir</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="sc">&#39;?&#39;</span><span class="p">,</span> <span class="k">const</span><span class="o">=</span><span class="n">None</span><span class="p">,</span> <span class="k">default</span><span class="o">=</span><span class="err">&#39;</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">vinay</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">type</span><span class="o">=</span><span class="n">None</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="n">None</span><span class="p">,</span> <span class="n">metavar</span><span class="o">=</span><span class="n">None</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">(</span><span class="err">&#39;</span><span class="n">somedir</span> <span class="o">-</span><span class="n">v</span><span class="err">&#39;</span><span class="p">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">Namespace</span><span class="p">(</span><span class="n">dir</span><span class="o">=</span><span class="err">&#39;</span><span class="n">somedir</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">(</span><span class="err">&#39;</span><span class="o">-</span><span class="n">v</span><span class="err">&#39;</span><span class="p">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">Namespace</span><span class="p">(</span><span class="n">dir</span><span class="o">=</span><span class="err">&#39;</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">vinay</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">(</span><span class="err">&#39;&#39;</span><span class="p">.</span><span class="n">split</span><span class="p">())</span>
<span class="n">Namespace</span><span class="p">(</span><span class="n">dir</span><span class="o">=</span><span class="err">&#39;</span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">vinay</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">([</span><span class="err">&#39;</span><span class="n">somedir</span><span class="err">&#39;</span><span class="p">])</span>
<span class="n">Namespace</span><span class="p">(</span><span class="n">dir</span><span class="o">=</span><span class="err">&#39;</span><span class="n">somedir</span><span class="err">&#39;</span><span class="p">,</span> <span class="n">v</span><span class="o">=</span><span class="n">False</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">parser</span><span class="p">.</span><span class="n">parse_args</span><span class="p">(</span><span class="err">&#39;</span><span class="n">somedir</span> <span class="o">-</span><span class="n">h</span> <span class="o">-</span><span class="n">v</span><span class="err">&#39;</span><span class="p">.</span><span class="n">split</span><span class="p">())</span>
<span class="nl">usage:</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">-</span><span class="n">v</span><span class="p">]</span> <span class="p">[</span><span class="n">dir</span><span class="p">]</span>

<span class="n">positional</span> <span class="n">arguments</span><span class="o">:</span>
<span class="n">dir</span>

<span class="n">optional</span> <span class="n">arguments</span><span class="o">:</span>
<span class="o">-</span><span class="n">h</span><span class="p">,</span> <span class="o">--</span><span class="n">help</span>  <span class="n">show</span> <span class="n">this</span> <span class="n">help</span> <span class="n">message</span> <span class="n">and</span> <span class="n">exit</span>
<span class="o">-</span><span class="n">v</span>
</pre></div>


<h3>Python中 <strong>new</strong> 和 __init__的用法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/674304/pythons-use-of-new-and-init">链接</a></p>
<p>我很疑惑，为何__init__总是在__new__之后调用</p>
<p>如下</p>
<div class="codehilite"><pre><span class="n">class</span> <span class="n">A</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">:</span>
    <span class="n">_dict</span> <span class="o">=</span> <span class="n">dict</span><span class="p">()</span>

    <span class="n">def</span> <span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span><span class="o">:</span>
        <span class="k">if</span> <span class="err">&#39;</span><span class="n">key</span><span class="err">&#39;</span> <span class="n">in</span> <span class="n">A</span><span class="p">.</span><span class="n">_dict</span><span class="o">:</span>
            <span class="n">print</span> <span class="s">&quot;EXISTS&quot;</span>
            <span class="k">return</span> <span class="n">A</span><span class="p">.</span><span class="n">_dict</span><span class="p">[</span><span class="err">&#39;</span><span class="n">key</span><span class="err">&#39;</span><span class="p">]</span>
        <span class="nl">else:</span>
            <span class="n">print</span> <span class="s">&quot;NEW&quot;</span>
            <span class="k">return</span> <span class="n">super</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">cls</span><span class="p">).</span><span class="n">__new__</span><span class="p">(</span><span class="n">cls</span><span class="p">)</span>

    <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
        <span class="n">print</span> <span class="s">&quot;INIT&quot;</span>
        <span class="n">A</span><span class="p">.</span><span class="n">_dict</span><span class="p">[</span><span class="err">&#39;</span><span class="n">key</span><span class="err">&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">self</span>
        <span class="n">print</span> <span class="s">&quot;&quot;</span>

<span class="n">a1</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="n">a2</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
<span class="n">a3</span> <span class="o">=</span> <span class="n">A</span><span class="p">()</span>
</pre></div>


<p>输出</p>
<div class="codehilite"><pre><span class="n">NEW</span>
<span class="n">INIT</span>

<span class="n">EXISTS</span>
<span class="n">INIT</span>

<span class="n">EXISTS</span>
<span class="n">INIT</span>
</pre></div>


<p>有木有人可以解释一下</p>
<p>来自 <a href="http://mail.python.org/pipermail/tutor/2008-April/061426.html">链接</a></p>
<p>使用__new__,当你需要控制一个实例的生成</p>
<p>使用__init__,当你需要控制一个实例的初始化</p>
<p>__new__是实例创建的第一步.最先被调用，并且负责返回类的一个新实例.</p>
<p>相反的,__init__不返回任何东西，只是负责在实例创建后进行初始化</p>
<p>通常情况下，你不必重写__new__除非你写一个子类继承不可变类型，例如str,int,unicode或tuple</p>
<p>你必须了解到，你尝试去做的用<a href="http://en.wikipedia.org/wiki/Factory_object">Factory</a>可以很好地解决，并且是最好的解决方式.使用__new__不是一个简洁的处理方式,一个<a href="http://code.activestate.com/recipes/86900/">factory例子</a></p>
<h3>Python 'self' 解释</h3>
<p>问题 <a href="http://stackoverflow.com/questions/2709821/python-self-explained">链接</a></p>
<p>self关键字的作用是什么？
我理解他用户在创建class时具体化实例，但我无法理解为何需要给每个方法加入self作为参数.</p>
<p>举例，在ruby中，我这么做:</p>
<div class="codehilite"><pre><span class="n">class</span> <span class="n">myClass</span>
    <span class="n">def</span> <span class="n">myFunc</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="err">@</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
    <span class="n">end</span>
<span class="n">end</span>
</pre></div>


<p>我可以很好地理解，非常简单.但是在Python中，我需要去加入self:</p>
<div class="codehilite"><pre><span class="n">class</span> <span class="n">myClass</span><span class="o">:</span>
    <span class="n">def</span> <span class="n">myFunc</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span><span class="o">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">name</span>
</pre></div>


<p>有谁能解释下么？</p>
<p>使用self关键字的原因是，Python没有@语法用于引用实例属性.Python决定用一种方式声明方法:实例对象自动传递给属于它的方法,但不是接收自动化：方法的第一个参数是调用这个方法的实例对象本身.这使得方法整个同函数一致,并且由你自己决定真实的名（虽然self是约定，但当你使用其他名的时候，通常人们并不乐意接受）.self对于代码不是特殊的，只是另一个对象.</p>
<p>Python本来可以做一些用来区分真实的名字和属性的区别 —— 像Ruby有的特殊语法，或者像C++/Java的命令声明,或者其他可能的的语法 —— 但是Python没有这么做.Python致力于使事情变得明确简单，让事情是其本身，虽然并不是全部地方都这么做，但是实例属性石这么做的！这就是为什么给一个实例属性赋值时需要知道是给哪个实例赋值,并且，这就是为什么需要self</p>
<p>举例</p>
<div class="codehilite"><pre><span class="n">class</span> <span class="n">Vector</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">:</span>
    <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">:</span>
        <span class="n">self</span><span class="p">.</span><span class="n">x</span> <span class="o">=</span> <span class="n">x</span>
        <span class="n">self</span><span class="p">.</span><span class="n">y</span> <span class="o">=</span> <span class="n">y</span>
    <span class="n">def</span> <span class="n">length</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
        <span class="k">return</span> <span class="n">math</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">self</span><span class="p">.</span><span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>


<p>等价于</p>
<div class="codehilite"><pre><span class="n">def</span> <span class="n">length_global</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span><span class="o">:</span>
    <span class="k">return</span> <span class="n">math</span><span class="p">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">vector</span><span class="p">.</span><span class="n">x</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">vector</span><span class="p">.</span><span class="n">y</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>


<p>另外</p>
<div class="codehilite"><pre><span class="n">v_instance</span><span class="p">.</span><span class="n">length</span><span class="p">()</span>
<span class="err">转为</span>
<span class="n">Vector</span><span class="p">.</span><span class="n">length</span><span class="p">(</span><span class="n">v_instance</span><span class="p">)</span>
</pre></div>


<h3>为什么Python的'private'方法并不是真正的私有方法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/70528/why-are-pythons-private-methods-not-actually-private">链接</a></p>
<p>Python允许我们创建'private' 函数：变量以两个下划线开头，像这样： <em>__myPrivateMethod()</em>.
但是，如何解释：</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">class</span> <span class="n">MyClass</span><span class="o">:</span>
<span class="p">...</span>     <span class="n">def</span> <span class="n">myPublicMethod</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>             <span class="n">print</span> <span class="err">&#39;</span><span class="n">public</span> <span class="n">method</span><span class="err">&#39;</span>
<span class="p">...</span>     <span class="n">def</span> <span class="n">__myPrivateMethod</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>             <span class="n">print</span> <span class="err">&#39;</span><span class="n">this</span> <span class="n">is</span> <span class="n">private</span><span class="o">!!</span><span class="err">&#39;</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">obj</span> <span class="o">=</span> <span class="n">MyClass</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">obj</span><span class="p">.</span><span class="n">myPublicMethod</span><span class="p">()</span>
<span class="n">public</span> <span class="n">method</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">obj</span><span class="p">.</span><span class="n">__myPrivateMethod</span><span class="p">()</span>
<span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="n">File</span> <span class="s">&quot;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">1</span><span class="p">,</span> <span class="n">in</span>
<span class="nl">AttributeError:</span> <span class="n">MyClass</span> <span class="n">instance</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="err">&#39;</span><span class="n">__myPrivateMethod</span><span class="err">&#39;</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">dir</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="p">[</span><span class="err">&#39;</span><span class="n">_MyClass__myPrivateMethod</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">__doc__</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">__module__</span><span class="err">&#39;</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">myPublicMethod</span><span class="err">&#39;</span><span class="p">]</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">obj</span><span class="p">.</span><span class="n">_MyClass__myPrivateMethod</span><span class="p">()</span>
<span class="n">this</span> <span class="n">is</span> <span class="n">private</span><span class="o">!!</span>
</pre></div>


<p>dir(obj) 和 obj._MyClass__myPrivateMethod()</p>
<p>回答</p>
<p>‘private'只是用作，确保子类不会意外覆写父类的私有方法和属性.不是为了保护外部意外访问而设计的！</p>
<p>例如:</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">class</span> <span class="n">Foo</span><span class="p">(</span><span class="n">object</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>     <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>         <span class="n">self</span><span class="p">.</span><span class="n">__baz</span> <span class="o">=</span> <span class="mi">42</span>
<span class="p">...</span>     <span class="n">def</span> <span class="n">foo</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>         <span class="n">print</span> <span class="n">self</span><span class="p">.</span><span class="n">__baz</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">class</span> <span class="n">Bar</span><span class="p">(</span><span class="n">Foo</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>     <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>         <span class="n">super</span><span class="p">(</span><span class="n">Bar</span><span class="p">,</span> <span class="n">self</span><span class="p">).</span><span class="n">__init__</span><span class="p">()</span>
<span class="p">...</span>         <span class="n">self</span><span class="p">.</span><span class="n">__baz</span> <span class="o">=</span> <span class="mi">21</span>
<span class="p">...</span>     <span class="n">def</span> <span class="n">bar</span><span class="p">(</span><span class="n">self</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>         <span class="n">print</span> <span class="n">self</span><span class="p">.</span><span class="n">__baz</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="n">Bar</span><span class="p">()</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">foo</span><span class="p">()</span>
<span class="mi">42</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">bar</span><span class="p">()</span>
<span class="mi">21</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print</span> <span class="n">x</span><span class="p">.</span><span class="n">__dict__</span>
<span class="p">{</span><span class="err">&#39;</span><span class="n">_Bar__baz</span><span class="err">&#39;</span><span class="o">:</span> <span class="mi">21</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">_Foo__baz</span><span class="err">&#39;</span><span class="o">:</span> <span class="mi">42</span><span class="p">}</span>
</pre></div>


<p>当然，这对于两个同名的类没有作用</p>
<p>另外，可以查看diveintopython的解释 <a href="http://www.faqs.org/docs/diveintopython/fileinfo_private.html#d0e11521">入口</a></p>
<h3>Python中类方法的作用是什么</h3>
<p>问题 <a href="http://stackoverflow.com/questions/38238/what-are-class-methods-in-python-for">链接</a></p>
<p>我现在意识到，我不需要像我在使用java的static方法那样使用类方法，但是我不确定什么时候使用</p>
<p>谁能通过一个好的例子解释下Python中的类方法，至少有人能告诉我什么时候确实需要使用类方法</p>
<p>类方法用在：当你需要使用不属于任何明确实例的方法,但同时必须涉及类.有趣的是，你可以在子类中覆写，这在Java的static方法和Python的模块级别函数中是不可能做到的</p>
<p>如果你有一个MyClass, 并且一个模块级别函数操作MyClass(工厂，依赖注入桩等等), 声明一个类方法.然后这个类方法可以在子类中调用</p>
<h3>如何删除一个list中重复的值同时保证原有顺序</h3>
<p>问题 <a href="http://stackoverflow.com/questions/480214/how-do-you-remove-duplicates-from-a-list-in-python-whilst-preserving-order">链接</a></p>
<p>我是这么做的额</p>
<div class="codehilite"><pre><span class="n">def</span> <span class="n">uniq</span><span class="p">(</span><span class="n">input</span><span class="p">)</span><span class="o">:</span>
<span class="n">output</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">x</span> <span class="n">in</span> <span class="n">input</span><span class="o">:</span>
    <span class="k">if</span> <span class="n">x</span> <span class="n">not</span> <span class="n">in</span> <span class="n">output</span><span class="o">:</span>
    <span class="n">output</span><span class="p">.</span><span class="n">append</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="k">return</span> <span class="n">output</span>
</pre></div>


<p>有什么更好的方法？</p>
<p>你可以在这里找到一些可用的方法 <a href="http://www.peterbe.com/plog/uniqifiers-benchmark">入口</a></p>
<p>最快的一个</p>
<div class="codehilite"><pre><span class="n">def</span> <span class="n">f7</span><span class="p">(</span><span class="n">seq</span><span class="p">)</span><span class="o">:</span>
    <span class="n">seen</span> <span class="o">=</span> <span class="n">set</span><span class="p">()</span>
    <span class="n">seen_add</span> <span class="o">=</span> <span class="n">seen</span><span class="p">.</span><span class="n">add</span>
    <span class="k">return</span> <span class="p">[</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="n">in</span> <span class="n">seq</span> <span class="k">if</span> <span class="n">x</span> <span class="n">not</span> <span class="n">in</span> <span class="n">seen</span> <span class="n">and</span> <span class="n">not</span> <span class="n">seen_add</span><span class="p">(</span><span class="n">x</span><span class="p">)]</span>
</pre></div>


<p>如果你需要在同一个数据集中多次是哦那个这个方法，或许你可以使用ordered set处理 http://code.activestate.com/recipes/528878/</p>
<p>插入，删除和归属判断复杂度都是O(1)</p>
<h3>有什么方法可以获取系统当前用户名么?</h3>
<p>问题 <a href="http://stackoverflow.com/questions/842059/is-there-a-portable-way-to-get-the-current-username-in-python">链接</a></p>
<p>至少在Linux和Windows下都可用.就像 os.getuid</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">os</span><span class="p">.</span><span class="n">getuid</span><span class="p">()</span>
<span class="mi">42</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">os</span><span class="p">.</span><span class="n">getusername</span><span class="p">()</span>
<span class="err">&#39;</span><span class="n">slartibartfast</span><span class="err">&#39;</span>
</pre></div>


<p>可以看看 <a href="http://docs.python.org/2/library/getpass.html">getpass</a> 模块</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">import</span> <span class="n">getpass</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">getpass</span><span class="p">.</span><span class="n">getuser</span><span class="p">()</span>
<span class="err">&#39;</span><span class="n">kostya</span><span class="err">&#39;</span>
</pre></div>


<p>可用: Unix, Windows</p>
<h3>Python assert最佳实践</h3>
<p>问题 <a href="http://stackoverflow.com/questions/944592/best-practice-for-python-assert">链接</a></p>
<p>有没有代码实例使用assert作为独立代码，而不是仅用来debug</p>
<div class="codehilite"><pre><span class="n">assert</span> <span class="n">x</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">x</span> <span class="n">is</span> <span class="n">less</span> <span class="n">than</span> <span class="n">zero</span><span class="err">&#39;</span>

<span class="err">类似</span>
<span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="o">:</span>
    <span class="n">raise</span> <span class="n">Exception</span><span class="p">,</span> <span class="err">&#39;</span><span class="n">x</span> <span class="n">is</span> <span class="n">less</span> <span class="n">than</span> <span class="n">zero</span><span class="err">&#39;</span>

<span class="err">有什么方法，可以设定一个规则就像</span> <span class="k">if</span> <span class="n">x</span> <span class="err">\</span><span class="o">&lt;</span> <span class="mi">0</span> <span class="err">抛出错误但是不是通过</span><span class="n">try</span><span class="o">/</span><span class="n">except</span><span class="o">/</span><span class="n">finally</span><span class="err">检查的</span>
</pre></div>


<p>搞晕了：</p>
<div class="codehilite"><pre><span class="err">原文</span> <span class="nx">Also</span><span class="p">,</span> <span class="nx">is</span> <span class="nx">there</span> <span class="nx">any</span> <span class="nx">way</span> <span class="nx">to</span> <span class="nx">set</span> <span class="nx">a</span> <span class="nx">business</span> <span class="nx">rule</span> <span class="nx">like</span> <span class="k">if</span> <span class="nx">x</span> <span class="err">\</span><span class="o">&lt;</span> <span class="mi">0</span> <span class="nx">raise</span> <span class="nx">error</span> <span class="nx">that</span> <span class="nx">is</span> <span class="nx">always</span> <span class="nx">checked</span> <span class="nx">without</span> <span class="nx">the</span> <span class="k">try</span><span class="err">/except/finally so, if at anytime throughout the code x is less than 0 an error is raised, like if you set assert x &lt; 0 at the start of a function, anywhere within the function where x becomes less then 0 an exception is raised?</span>
</pre></div>


<p>回答</p>
<p>Assert仅用在，测试那些从不发生的情况！目的是让程序尽早失败</p>
<p>Exception用在，那些可以明确知道会发生的错误，并且建议总是创建自己的异常类</p>
<p>例如，你写一个函数从配置文件中读取配置放入字典，文件格式不正确抛出一个ConfigurationSyntaxError,同时你可以assert返回值非None</p>
<p>在你的例子中，如果x是通过用户接口或外部传递设置的，最好使用exception</p>
<p>如果x仅是同一个程序的内部代码，使用assert</p>
<h3>在非创建全局变量的地方使用全局变量</h3>
<p>问题 <a href="http://stackoverflow.com/questions/423379/using-global-variables-in-a-function-other-than-the-one-that-created-them">链接</a></p>
<p>如果我在一个函数中创建了全局变量，如何在另一个函数中使用？</p>
<p>回答：</p>
<p>你可以在给全局变量赋值的函数中声明 global</p>
<div class="codehilite"><pre><span class="n">globvar</span> <span class="o">=</span> <span class="mi">0</span>

<span class="n">def</span> <span class="n">set_globvar_to_one</span><span class="p">()</span><span class="o">:</span>
    <span class="n">global</span> <span class="n">globvar</span>    <span class="err">#</span> <span class="n">Needed</span> <span class="n">to</span> <span class="n">modify</span> <span class="n">global</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">globvar</span>
    <span class="n">globvar</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">def</span> <span class="n">print_globvar</span><span class="p">()</span><span class="o">:</span>
    <span class="n">print</span> <span class="n">globvar</span>     <span class="err">#</span> <span class="n">No</span> <span class="n">need</span> <span class="k">for</span> <span class="n">global</span> <span class="n">declaration</span> <span class="n">to</span> <span class="n">read</span> <span class="n">value</span> <span class="n">of</span> <span class="n">globvar</span>

<span class="n">set_globvar_to_one</span><span class="p">()</span>
<span class="n">print_globvar</span><span class="p">()</span>       <span class="err">#</span> <span class="n">Prints</span> <span class="mi">1</span>
</pre></div>


<p>我猜想这么做的原因是，全局变量很危险，Python想要确保你真的知道你要对一个全局的变量进行操作</p>
<p>如果你想知道如何在模块间使用全局变量，查看其他回答</p>
<h3>如何在单一表达式中合并两个Python字典</h3>
<p>问题 <a href="http://stackoverflow.com/questions/38987/how-can-i-merge-union-two-python-dictionaries-in-a-single-expression">链接</a></p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;b&#39;</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span> <span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">11</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">z</span> <span class="o">=</span> <span class="n">x</span><span class="p">.</span><span class="n">update</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">print</span> <span class="n">z</span>
<span class="n">None</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">x</span>
<span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">10</span><span class="p">,</span> <span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">11</span><span class="p">}</span>
</pre></div>


<p>我想要最终合并结果在z中，不是x，我要怎么做？</p>
<p>回答</p>
<p>这种情况下，可以使用</p>
<div class="codehilite"><pre><span class="n">z</span> <span class="o">=</span> <span class="n">dict</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">items</span><span class="p">()</span> <span class="o">+</span> <span class="n">y</span><span class="p">.</span><span class="n">items</span><span class="p">())</span>
</pre></div>


<p>这个表达式将会实现你想要的，最终结果z，并且相同key的值，将会是y中key对应的值</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">x</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span><span class="mi">1</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">2</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">y</span> <span class="o">=</span> <span class="p">{</span><span class="sc">&#39;b&#39;</span><span class="o">:</span><span class="mi">10</span><span class="p">,</span> <span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">11</span><span class="p">}</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">z</span> <span class="o">=</span> <span class="n">dict</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">items</span><span class="p">()</span> <span class="o">+</span> <span class="n">y</span><span class="p">.</span><span class="n">items</span><span class="p">())</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">z</span>
<span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">11</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">10</span><span class="p">}</span>
</pre></div>


<p>如果在Python3中,会变得有些复杂</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">z</span> <span class="o">=</span> <span class="n">dict</span><span class="p">(</span><span class="n">list</span><span class="p">(</span><span class="n">x</span><span class="p">.</span><span class="n">items</span><span class="p">())</span> <span class="o">+</span> <span class="n">list</span><span class="p">(</span><span class="n">y</span><span class="p">.</span><span class="n">items</span><span class="p">()))</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">z</span>
<span class="p">{</span><span class="sc">&#39;a&#39;</span><span class="o">:</span> <span class="mi">1</span><span class="p">,</span> <span class="sc">&#39;c&#39;</span><span class="o">:</span> <span class="mi">11</span><span class="p">,</span> <span class="sc">&#39;b&#39;</span><span class="o">:</span> <span class="mi">10</span><span class="p">}</span>
</pre></div>


<h3>如何使用 pip 更新所有包</h3>
<p>问题 <a href="http://stackoverflow.com/questions/2720014/upgrading-all-packages-with-pip">链接</a></p>
<p>如何使用pip更新python的所有包</p>
<p>没有内置的标志可以实现</p>
<p>但是你可以这么做</p>
<div class="codehilite"><pre><span class="n">pip</span> <span class="n">freeze</span> <span class="o">--</span><span class="n">local</span> <span class="o">|</span> <span class="n">grep</span> <span class="o">-</span><span class="n">v</span> <span class="err">&#39;</span><span class="o">^</span><span class="err">\</span><span class="o">-</span><span class="n">e</span><span class="err">&#39;</span> <span class="o">|</span> <span class="n">cut</span> <span class="o">-</span><span class="n">d</span> <span class="o">=</span> <span class="o">-</span><span class="n">f</span> <span class="mi">1</span>  <span class="o">|</span> <span class="n">xargs</span> <span class="n">pip</span> <span class="n">install</span> <span class="o">-</span><span class="n">U</span>
</pre></div>


<h3>Python中声明exception的方法</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1319615/proper-way-to-declare-custom-exceptions-in-modern-python">链接</a></p>
<p>在python2.6中定义异常得到警告</p>
<div class="codehilite"><pre><span class="o">&gt;&gt;&gt;</span> <span class="n">class</span> <span class="n">MyError</span><span class="p">(</span><span class="n">Exception</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>     <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span><span class="o">:</span>
<span class="p">...</span>         <span class="n">self</span><span class="p">.</span><span class="n">message</span> <span class="o">=</span> <span class="n">message</span>
<span class="p">...</span>
<span class="o">&gt;&gt;&gt;</span> <span class="n">MyError</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">)</span>
<span class="n">_sandbox</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="mi">3</span><span class="o">:</span> <span class="n">DeprecationWarning</span><span class="o">:</span> <span class="n">BaseException</span><span class="p">.</span><span class="n">message</span> <span class="n">has</span> <span class="n">been</span> <span class="n">deprecated</span> <span class="n">as</span> <span class="n">of</span> <span class="n">Python</span> <span class="mf">2.6</span>
</pre></div>


<p>问题很长，大意如标题</p>
<p>回答</p>
<p>或许我理解错了，但是为什么不这样做</p>
<div class="codehilite"><pre><span class="n">class</span> <span class="n">MyException</span><span class="p">(</span><span class="n">Exception</span><span class="p">)</span><span class="o">:</span>
    <span class="n">pass</span>
</pre></div>


<p>如果要重写什么，例如传递额外参数，可以这么做</p>
<div class="codehilite"><pre><span class="n">class</span> <span class="n">ValidationError</span><span class="p">(</span><span class="n">Exception</span><span class="p">)</span><span class="o">:</span>
    <span class="n">def</span> <span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">,</span> <span class="n">Errors</span><span class="p">)</span><span class="o">:</span>

        <span class="err">#</span> <span class="n">Call</span> <span class="n">the</span> <span class="n">base</span> <span class="n">class</span> <span class="n">constructor</span> <span class="n">with</span> <span class="n">the</span> <span class="n">parameters</span> <span class="n">it</span> <span class="n">needs</span>
        <span class="n">Exception</span><span class="p">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">self</span><span class="p">,</span> <span class="n">message</span><span class="p">)</span>

        <span class="err">#</span> <span class="n">Now</span> <span class="k">for</span> <span class="n">your</span> <span class="n">custom</span> <span class="n">code</span><span class="p">...</span>
        <span class="n">self</span><span class="p">.</span><span class="n">Errors</span> <span class="o">=</span> <span class="n">Errors</span>
</pre></div>


<p>你可以通过第二个参数传递error 字典, 之后通过e.Errors获取</p>
<h3>在Python中使用Counter错误</h3>
<p>问题 <a href="http://stackoverflow.com/questions/13311094/counter-in-collections-module-python">链接</a></p>
<p>当使用Counter时，出现异常</p>
<div class="codehilite"><pre><span class="nl">AttributeError:</span> <span class="err">&#39;</span><span class="n">module</span><span class="err">&#39;</span> <span class="n">object</span> <span class="n">has</span> <span class="n">no</span> <span class="n">attribute</span> <span class="err">&#39;</span><span class="n">Counter</span><span class="err">&#39;</span>

<span class="n">from</span> <span class="n">collections</span> <span class="n">import</span> <span class="n">Counter</span>
<span class="nl">ImportError:</span> <span class="n">cannot</span> <span class="n">import</span> <span class="n">name</span> <span class="n">Counter</span>
</pre></div>


<p>原因：</p>
<p>版本问题，Counter在 python2.7中才被加入到这个模块，你可能使用了Python2.6或更老的版本</p>
<p>可以看下 <a href="http://docs.python.org/2/library/collections.html#collections.Counter">文档</a></p>
<p>如果要在 Python2.6或2.5版本使用，可以看 <a href="http://code.activestate.com/recipes/576611-counter-class/">这里</a></p>
<h3>如何删除Python easy_install安装的包</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1231688/how-do-i-remove-packages-installed-with-pythons-easy-install">链接</a></p>
<p><a href="https://pypi.python.org/pypi/pip/">pip</a>, setuptools/easy_install的另一种选择，提供uninstall命令</p>
<p>首先，移除依赖</p>
<div class="codehilite"><pre><span class="err">$</span> <span class="n">easy_install</span> <span class="o">-</span><span class="n">m</span> <span class="p">[</span><span class="n">PACKAGE</span><span class="p">]</span>
</pre></div>


<p>然后，手动删除egg文件</p>
<div class="codehilite"><pre><span class="err">$</span> <span class="n">rm</span> <span class="o">-</span><span class="n">rf</span> <span class="p">...</span><span class="o">/</span><span class="n">python2</span><span class="p">.</span><span class="n">X</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="p">[</span><span class="n">PACKAGE</span><span class="p">].</span><span class="n">egg</span>
</pre></div>


<h3>在Python中如何解析xml</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1912434/how-do-i-parse-xml-in-python">链接</a></p>
<div class="codehilite"><pre><span class="nt">&lt;foo&gt;</span>
<span class="nt">&lt;bar&gt;</span>
    <span class="nt">&lt;type</span> <span class="na">foobar=</span><span class="s">&quot;1&quot;</span><span class="nt">/&gt;</span>
    <span class="nt">&lt;type</span> <span class="na">foobar=</span><span class="s">&quot;2&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/bar&gt;</span>
<span class="nt">&lt;/foo&gt;</span>
</pre></div>


<p>如何解析获取xml文件中内容</p>
<p>我建议使用 <a href="http://docs.python.org/2/library/xml.etree.elementtree.html">ElementTree</a> (有其他可用的实现，例如 <a href="http://lxml.de/">lxml</a>，他们只是更快, ElementTree提供更简单的编程api)</p>
<p>在使用XML建立Element实例之后，例如使用 <a href="http://docs.python.org/2/library/xml.etree.elementtree.html#xml.etree.ElementTree.XML">XML</a> 函数</p>
<div class="codehilite"><pre><span class="k">for</span> <span class="n">atype</span> <span class="n">in</span> <span class="n">e</span><span class="p">.</span><span class="n">findall</span><span class="p">(</span><span class="err">&#39;</span><span class="n">type</span><span class="err">&#39;</span><span class="p">)</span>
    <span class="n">print</span><span class="p">(</span><span class="n">atype</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="err">&#39;</span><span class="n">foobar</span><span class="err">&#39;</span><span class="p">))</span>
</pre></div>


<h3>如何将一个Python time.struct_time对象转换为一个datetime对象</h3>
<p>问题 <a href="http://stackoverflow.com/questions/1697815/how-do-you-convert-a-python-time-struct-time-object-into-a-datetime-object">链接</a></p>
<p>使用 <a href="">time.mktime()</a> 将time元组(本地时间)转成秒， 然后使用 datetime.fromtimestamp() 转成datetime对象</p>
<div class="codehilite"><pre><span class="n">from</span> <span class="n">time</span> <span class="n">import</span> <span class="n">mktime</span>
<span class="n">from</span> <span class="n">datetime</span> <span class="n">import</span> <span class="n">datetime</span>

<span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="p">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">mktime</span><span class="p">(</span><span class="k">struct</span><span class="p">))</span>
</pre></div>
    </section>

    <section id="copyright">
        <div class="copyright">
            版权声明：自由转载-非商用-非衍生-保持署名 | <a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh" target="_blank" >Creative Commons BY-NC-ND 3.0</a>
        </div>

        <div class="donation">
            <center>
            <img src="/imgs/life/donation.png"/>
            如果你觉得我的文章或项目对你有所帮助, You can buy me a coffee:)
            </center>
        </div>
    </section>


    <section id="neighbors">
        <div>
                        <a class="left" href="http://www.wklken.me/posts/2013/07/19/python-translate-decorator.html">
                            上一篇:  [翻译]理解python中的装饰器
                        </a>
                        <a class="right" href="http://www.wklken.me/posts/2013/08/04/translation-vim-introduction-and-tutorial.html">
                            下一篇: [翻译]vim入门指南
                        </a>
        </div>
    </section>

<section id="comments">
<div id="tabs">
    <ul>
        <li><a href="#tabs-disqus">DISQUS</a> </li>
        <li><a href="#tabs-duoshuo">多说</a> </li>
    </ul>
    <div id="tabs-disqus">
        <div class="comments">
            <div id="disqus_thread"></div>
            <script type="text/javascript">
                var disqus_identifier = "posts/2013/07/20/python-stackoverflow-vote-top.html";
                (function() {
                var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                dsq.src = 'http://wklken.disqus.com/embed.js';
                (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                })();
            </script>
            </div>
    </div>
    <div id="tabs-duoshuo">
        <!-- 多说评论框 start -->
            <div class="ds-thread" data-thread-key="[翻译整理]stackoverflow python 百问" data-title="[翻译整理]stackoverflow python 百问" data-url="posts/2013/07/20/python-stackoverflow-vote-top.html"></div>
        <!-- 多说评论框 end -->
        <!-- 多说公共JS代码 start (一个网页只需插入一次) -->
        <script type="text/javascript">
        var duoshuoQuery = {short_name:"wklken"};
            (function() {
                var ds = document.createElement('script');
                ds.type = 'text/javascript';ds.async = true;
                ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
                ds.charset = 'UTF-8';
                (document.getElementsByTagName('head')[0] 
                || document.getElementsByTagName('body')[0]).appendChild(ds);
            })();
            </script>
        <!-- 多说公共JS代码 end -->
    </div>
</div>
<div id="tabid"></div>
    </section>
</article>
        </section><!--end #main-->

            <footer class="row">
                <div class="large-12 columns">
                    <p>
                            Copyright © 2014 wklken <br>
                            Hosted on <a href="https://www.digitalocean.com/?refcode=8ee73f2c47ce"> digitalocean </a>. Powered by <a href="http://alexis.notmyidea.org/pelican/">pelican</a>. Search Powered by <a href="https://swiftype.com/">Swiftype </a>Social Icons by <a href="http://fortawesome.github.io/Font-Awesome/">Font-Awesome</a>.
                    </p>
                </div>
            </footer>

            </div>
        </div>

        <section id="extras" class="body">
        </section><!-- /#extras -->

    <script type="text/javascript">
    var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
    document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
    </script>
    <script type="text/javascript">
    try {
        var pageTracker = _gat._getTracker("UA-42275748-1");
    pageTracker._trackPageview();
    } catch(err) {}</script>



</body>
<script src="http://apps.bdimg.com/libs/jquery/2.1.1/jquery.min.js"></script>
<script src="http://apps.bdimg.com/libs/jquery-scrollUp/2.1.0/jquery.scrollUp.min.js"></script>
<script src="http://apps.bdimg.com/libs/jqueryui/1.10.4/jquery-ui.min.js"></script>
<script>
    $(function(){
        $.scrollUp({
              scrollText: '', // Text for element, can contain HTML
            });
    });
</script>
<script type="text/javascript">
  var Swiftype = window.Swiftype || {};
  Swiftype.searchSearchFields = {
    "page": ["title^10", "body"]
  };

  (function(w,d,t,u,n,s,e){w['SwiftypeObject']=n;w[n]=w[n]||function(){
  (w[n].q=w[n].q||[]).push(arguments);};s=d.createElement(t);
  e=d.getElementsByTagName(t)[0];s.async=1;s.src=u;e.parentNode.insertBefore(s,e);
  })(window,document,'script','//s.swiftypecdn.com/install/v1/st.js','_st');

  _st('install','v6K-_DamCeHvwX6z3o2F');
</script>

<div id="share">
<script>
    window._bd_share_config={"common":{"bdSnsKey":{},"bdText":"","bdMini":"1","bdMiniList":["tsina","weixin","douban","youdao","sdo","qingbiji","mail","twi","deli","linkedin","copy","print"],"bdPic":"","bdStyle":"0","bdSize":"16"},"slide":{"type":"slide","bdImg":"5","bdPos":"right","bdTop":"45"}};with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='http://bdimg.share.baidu.com/static/api/js/share.js?v=89860593.js?cdnversion='+~(-new Date()/36e5)];
</script>
</div>

  <script>
  $(function() {
    $( "#tabs" ).tabs();
  });
  </script>
</html>